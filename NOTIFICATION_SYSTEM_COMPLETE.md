# ๐ ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงููุงูู - ุฏููู ุดุงูู

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทุจูู ูุธุงู ุฅุดุนุงุฑุงุช ูุชูุงูู ูู ูุธุงู Pipefy ูุน ุฌููุน ุงูู API endpoints ูุงููุงุฌูุฉ ุงูุฃูุงููุฉ.

---

## โ ูุง ุชู ุชุทุจููู

### 1. Backend API Endpoints

ุฌููุน ุงูู endpoints ุงูุชุงููุฉ ูุชุงุญุฉ ููุฏุนููุฉ:

#### ๐ฅ ุฌูุจ ุงูุฅุดุนุงุฑุงุช
```
GET /api/notifications
Query Parameters:
  - page: number (default: 1)
  - per_page: number (default: 20)
  - is_read: boolean (optional)
  - type: 'info' | 'success' | 'warning' | 'error' (optional)

Response:
{
  "success": true,
  "data": [
    {
      "id": "uuid",
      "user_id": "uuid",
      "title": "ุนููุงู ุงูุฅุดุนุงุฑ",
      "message": "ูุญุชูู ุงูุฅุดุนุงุฑ",
      "type": "info",
      "is_read": false,
      "data": {},
      "created_at": "2025-01-10T00:00:00Z",
      "read_at": null
    }
  ],
  "pagination": {
    "page": 1,
    "per_page": 20,
    "total": 50,
    "total_pages": 3
  }
}
```

#### ๐ค ุฅูุดุงุก ุฅุดุนุงุฑ ุฌุฏูุฏ
```
POST /api/notifications
Body:
{
  "user_id": "uuid",
  "title": "ุนููุงู ุงูุฅุดุนุงุฑ",
  "message": "ูุญุชูู ุงูุฅุดุนุงุฑ",
  "type": "info",
  "data": {}
}
```

#### ๐ข ุนุฏุฏ ุงูุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ
```
GET /api/notifications/unread-count

Response:
{
  "success": true,
  "data": {
    "count": 5
  }
}
```

#### ๐จ ุฅุฑุณุงู ุฅุดุนุงุฑ ุฌูุงุนู
```
POST /api/notifications/bulk
Body:
{
  "user_ids": ["uuid1", "uuid2", "uuid3"],
  "title": "ุนููุงู ุงูุฅุดุนุงุฑ",
  "message": "ูุญุชูู ุงูุฅุดุนุงุฑ",
  "type": "info",
  "data": {}
}

Response:
{
  "success": true,
  "data": {
    "sent_count": 3
  }
}
```

#### โ ุชุญุฏูุฏ ุฅุดุนุงุฑ ูููุฑูุก
```
PATCH /api/notifications/{id}/read

Response:
{
  "success": true,
  "data": {
    "id": "uuid",
    "is_read": true,
    "read_at": "2025-01-10T00:00:00Z"
  }
}
```

#### โโ ุชุญุฏูุฏ ุฌููุน ุงูุฅุดุนุงุฑุงุช ูููุฑูุกุฉ
```
PATCH /api/notifications/mark-all-read

Response:
{
  "success": true,
  "data": {
    "updated_count": 10
  }
}
```

#### ๐๏ธ ุญุฐู ุฅุดุนุงุฑ
```
DELETE /api/notifications/{id}

Response:
{
  "success": true,
  "message": "ุชู ุญุฐู ุงูุฅุดุนุงุฑ ุจูุฌุงุญ"
}
```

#### ๐๏ธ๐๏ธ ุญุฐู ุฌููุน ุงูุฅุดุนุงุฑุงุช ุงูููุฑูุกุฉ
```
DELETE /api/notifications/delete-read

Response:
{
  "success": true,
  "data": {
    "deleted_count": 15
  }
}
```

---

### 2. Frontend Service (notificationService.ts)

ุชู ุฅูุดุงุก service ูุงูู ููุชุนุงูู ูุน ุฌููุน ุงูู API endpoints:

```typescript
import notificationService from './services/notificationService';

// ุฌูุจ ุงูุฅุดุนุงุฑุงุช
const notifications = await notificationService.getNotifications({
  page: 1,
  per_page: 20,
  is_read: false
});

// ุฅูุดุงุก ุฅุดุนุงุฑ
await notificationService.createNotification({
  user_id: 'uuid',
  title: 'ุฅุดุนุงุฑ ุฌุฏูุฏ',
  message: 'ูุญุชูู ุงูุฅุดุนุงุฑ',
  type: 'success'
});

// ุนุฏุฏ ุบูุฑ ุงูููุฑูุกุฉ
const count = await notificationService.getUnreadCount();

// ุฅุฑุณุงู ุฌูุงุนู
await notificationService.sendBulkNotification({
  user_ids: ['uuid1', 'uuid2'],
  title: 'ุฅุดุนุงุฑ ุฌูุงุนู',
  message: 'ูุญุชูู ุงูุฅุดุนุงุฑ'
});

// ุชุญุฏูุฏ ูููุฑูุก
await notificationService.markAsRead('notification-id');

// ุชุญุฏูุฏ ุงููู ูููุฑูุก
await notificationService.markAllAsRead();

// ุญุฐู ุฅุดุนุงุฑ
await notificationService.deleteNotification('notification-id');

// ุญุฐู ุงูููุฑูุกุฉ
await notificationService.deleteReadNotifications();
```

---

### 3. Frontend Component (NotificationBell.tsx)

ูููู React ูุงูู ูุน ุฌููุน ุงูููุฒุงุช:

#### ุงูููุฒุงุช:
- โ ุฃููููุฉ ุฌุฑุณ ุฌูููุฉ
- โ ุนุฏุงุฏ ุงูุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ (Badge)
- โ ูุงุฆูุฉ ููุณุฏูุฉ ููุฅุดุนุงุฑุงุช
- โ ุชุญุฏูุฏ ุฅุดุนุงุฑ ูููุฑูุก
- โ ุชุญุฏูุฏ ุงููู ูููุฑูุก
- โ ุญุฐู ุฅุดุนุงุฑ
- โ ุญุฐู ุฌููุน ุงูููุฑูุกุฉ
- โ ุชุญุฏูุซ ุชููุงุฆู ูู 30 ุซุงููุฉ
- โ ุฅุบูุงู ุชููุงุฆู ุนูุฏ ุงูุถุบุท ุฎุงุฑุฌ ุงููุงุฆูุฉ
- โ ุฃููููุงุช ูุฃููุงู ุญุณุจ ููุน ุงูุฅุดุนุงุฑ
- โ ุนุฑุถ ุงูููุช ุจุงูุนุฑุจูุฉ (ููุฐ 5 ุฏูุงุฆู)

---

## ๐จ ุงููุงุฌูุฉ

### 1. ุฃููููุฉ ุงูุฌุฑุณ ูู Header

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ [โฐ] ูุธุงู ุฅุฏุงุฑุฉ ุงูุนูููุงุช    [๐5] [๐ค]  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

- **ุงูุฌุฑุณ**: ุฃููููุฉ Bell
- **ุงูุนุฏุงุฏ**: ุฑูู ุฃุญูุฑ ูุธูุฑ ุนุฏุฏ ุงูุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ
- **ุฅุฐุง ูุงู ุงูุนุฏุฏ > 99**: ูุธูุฑ "99+"

---

### 2. ุงููุงุฆูุฉ ุงูููุณุฏูุฉ

ุนูุฏ ุงูุถุบุท ุนูู ุงูุฌุฑุณ:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ุงูุฅุดุนุงุฑุงุช              [โโ] [๐] [ร] โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ                                        โ
โ โ ุชู ุฅูุดุงุก ุชุฐูุฑุฉ ุฌุฏูุฏุฉ              โ
โ    ุชู ุฅูุดุงุก ุงูุชุฐูุฑุฉ #123 ุจูุฌุงุญ       โ
โ    ููุฐ 5 ุฏูุงุฆู            [โ] [๐]   โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ๏ธ ุชุญุฐูุฑ: ุชุฐูุฑุฉ ูุชุฃุฎุฑุฉ               โ
โ    ุงูุชุฐูุฑุฉ #456 ูุชุฃุฎุฑุฉ ุนู ููุนุฏูุง     โ
โ    ููุฐ ุณุงุนุฉ                [โ] [๐]   โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โน๏ธ ุชุญุฏูุซ ุงููุธุงู                       โ
โ    ุชู ุชุญุฏูุซ ุงููุธุงู ุฅูู ุงูุฅุตุฏุงุฑ 2.0   โ
โ    ููุฐ ููููู              [โ] [๐]    โ
โ                                        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ        ุนุฑุถ ุฌููุน ุงูุฅุดุนุงุฑุงุช             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

#### ุงูุฃุฒุฑุงุฑ ูู Header ุงููุงุฆูุฉ:
- **[โโ]**: ุชุญุฏูุฏ ุฌููุน ุงูุฅุดุนุงุฑุงุช ูููุฑูุกุฉ
- **[๐]**: ุญุฐู ุฌููุน ุงูุฅุดุนุงุฑุงุช ุงูููุฑูุกุฉ
- **[ร]**: ุฅุบูุงู ุงููุงุฆูุฉ

#### ุงูุฃุฒุฑุงุฑ ููู ุฅุดุนุงุฑ:
- **[โ]**: ุชุญุฏูุฏ ูุฐุง ุงูุฅุดุนุงุฑ ูููุฑูุก (ูุธูุฑ ููุท ููุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ)
- **[๐]**: ุญุฐู ูุฐุง ุงูุฅุดุนุงุฑ

---

### 3. ุฃููุงุน ุงูุฅุดุนุงุฑุงุช ูุงูุฃููุงู

| ุงูููุน | ุงูุฃููููุฉ | ุงูููู | ุงูุงุณุชุฎุฏุงู |
|-------|---------|-------|-----------|
| **info** | โน๏ธ | ุฃุฒุฑู | ูุนูููุงุช ุนุงูุฉ |
| **success** | โ | ุฃุฎุถุฑ | ุนูููุงุช ูุงุฌุญุฉ |
| **warning** | โ๏ธ | ุฃุตูุฑ | ุชุญุฐูุฑุงุช |
| **error** | โ | ุฃุญูุฑ | ุฃุฎุทุงุก |

---

### 4. ุญุงูุงุช ุงูุฅุดุนุงุฑ

#### ุบูุฑ ููุฑูุก:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ต ุฎูููุฉ ุฒุฑูุงุก ูุงุชุญุฉ              โ
โ โ ุชู ุฅูุดุงุก ุชุฐูุฑุฉ ุฌุฏูุฏุฉ           โ
โ    ูุญุชูู ุงูุฅุดุนุงุฑ...               โ
โ    ููุฐ 5 ุฏูุงุฆู        [โ] [๐]   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

#### ููุฑูุก:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โช ุฎูููุฉ ุจูุถุงุก                    โ
โ โน๏ธ ุชุญุฏูุซ ุงููุธุงู                   โ
โ    ูุญุชูู ุงูุฅุดุนุงุฑ...               โ
โ    ููุฐ ููููู              [๐]    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ูู ุงูููุฏ (ุฅุฑุณุงู ุฅุดุนุงุฑ)

```typescript
import notificationService from './services/notificationService';

// ุฅุฑุณุงู ุฅุดุนุงุฑ ููุณุชุฎุฏู ูุงุญุฏ
await notificationService.createNotification({
  user_id: 'user-uuid',
  title: 'ุชู ุฅูุดุงุก ุชุฐูุฑุฉ ุฌุฏูุฏุฉ',
  message: 'ุชู ุฅูุดุงุก ุงูุชุฐูุฑุฉ #123 ุจูุฌุงุญ',
  type: 'success',
  data: {
    ticket_id: '123',
    ticket_number: 'TKT-123'
  }
});

// ุฅุฑุณุงู ุฅุดุนุงุฑ ูุนุฏุฉ ูุณุชุฎุฏููู
await notificationService.sendBulkNotification({
  user_ids: ['user1-uuid', 'user2-uuid', 'user3-uuid'],
  title: 'ุงุฌุชูุงุน ุฌุฏูุฏ',
  message: 'ุชู ุฌุฏููุฉ ุงุฌุชูุงุน ุบุฏุงู ุงูุณุงุนุฉ 10 ุตุจุงุญุงู',
  type: 'info'
});
```

---

### 2. ูู ุงููุงุฌูุฉ (ุงููุณุชุฎุฏู)

#### ุฑุคูุฉ ุงูุฅุดุนุงุฑุงุช:
```bash
1. ุงูุธุฑ ุฅูู ุฃููููุฉ ุงูุฌุฑุณ ๐ ูู Header
2. ุฅุฐุง ูุงู ููุงู ุนุฏุงุฏ ุฃุญูุฑุ ูุฏูู ุฅุดุนุงุฑุงุช ุฌุฏูุฏุฉ
3. ุงุถุบุท ุนูู ุงูุฌุฑุณ ููุชุญ ุงููุงุฆูุฉ
```

#### ุชุญุฏูุฏ ูููุฑูุก:
```bash
1. ุงูุชุญ ุงููุงุฆูุฉ
2. ุงุถุบุท ุนูู [โ] ุจุฌุงูุจ ุงูุฅุดุนุงุฑ
3. ุณูุชุบูุฑ ููู ุงูุฎูููุฉ ุฅูู ุฃุจูุถ
4. ุณููุฎูุถ ุงูุนุฏุงุฏ
```

#### ุญุฐู ุฅุดุนุงุฑ:
```bash
1. ุงูุชุญ ุงููุงุฆูุฉ
2. ุงุถุบุท ุนูู [๐] ุจุฌุงูุจ ุงูุฅุดุนุงุฑ
3. ุณูุฎุชูู ุงูุฅุดุนุงุฑ ููุฑุงู
```

#### ุชุญุฏูุฏ ุงููู ูููุฑูุก:
```bash
1. ุงูุชุญ ุงููุงุฆูุฉ
2. ุงุถุบุท ุนูู [โโ] ูู Header ุงููุงุฆูุฉ
3. ุฌููุน ุงูุฅุดุนุงุฑุงุช ุณุชุตุจุญ ููุฑูุกุฉ
4. ุงูุนุฏุงุฏ ุณูุตุจุญ 0
```

#### ุญุฐู ุฌููุน ุงูููุฑูุกุฉ:
```bash
1. ุงูุชุญ ุงููุงุฆูุฉ
2. ุงุถุบุท ุนูู [๐] ูู Header ุงููุงุฆูุฉ
3. ุฌููุน ุงูุฅุดุนุงุฑุงุช ุงูููุฑูุกุฉ ุณุชูุญุฐู
```

---

## ๐ ุงูุชุญุฏูุซ ุงูุชููุงุฆู

ุงููุธุงู ูููู ุจู:
- โ ุฌูุจ ุนุฏุฏ ุงูุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ ูู **30 ุซุงููุฉ**
- โ ุชุญุฏูุซ ุงูุนุฏุงุฏ ุชููุงุฆูุงู
- โ ุฌูุจ ูุงุฆูุฉ ุงูุฅุดุนุงุฑุงุช ุนูุฏ ูุชุญ ุงููุงุฆูุฉ

---

## ๐ ุงููููุงุช ุงููููุดุฃุฉ

### Frontend:
1. **`src/services/notificationService.ts`**
   - Service ููุชุนุงูู ูุน ุฌููุน API endpoints
   - ุฌููุน ุงูุฏูุงู ูุน TypeScript types

2. **`src/components/notifications/NotificationBell.tsx`**
   - ูููู ุงูุฌุฑุณ ูุงููุงุฆูุฉ ุงูููุณุฏูุฉ
   - ุฌููุน ุงูููุฒุงุช ูุงูุชูุงุนูุงุช

3. **`src/App.tsx`** (ุชู ุงูุชุนุฏูู)
   - ุฅุถุงูุฉ import ููู NotificationBell
   - ุฅุถุงูุฉ ุงููููู ูู Header

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### 1. ุงุฎุชุจุงุฑ ุงููุงุฌูุฉ:

```bash
# 1. ุฃุนุฏ ุชุญููู ุงูุตูุญุฉ
Ctrl+Shift+R

# 2. ุชุญูู ูู ุฃููููุฉ ุงูุฌุฑุณ
ูุฌุจ ุฃู ุชุธูุฑ ูู Header ุจุฌุงูุจ ุฃููููุฉ ุงููุณุชุฎุฏู

# 3. ุงูุชุญ Console (F12)
ุชุญูู ูู ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก

# 4. ุงุถุบุท ุนูู ุงูุฌุฑุณ
ูุฌุจ ุฃู ุชูุชุญ ุงููุงุฆูุฉ ุงูููุณุฏูุฉ
```

### 2. ุงุฎุชุจุงุฑ API:

```bash
# ุฌูุจ ุงูุฅุดุนุงุฑุงุช
GET http://localhost:3000/api/notifications

# ุฅูุดุงุก ุฅุดุนุงุฑ ุชุฌุฑูุจู
POST http://localhost:3000/api/notifications
{
  "user_id": "your-user-id",
  "title": "ุฅุดุนุงุฑ ุชุฌุฑูุจู",
  "message": "ูุฐุง ุฅุดุนุงุฑ ููุงุฎุชุจุงุฑ",
  "type": "info"
}

# ุนุฏุฏ ุบูุฑ ุงูููุฑูุกุฉ
GET http://localhost:3000/api/notifications/unread-count
```

---

## ๐จ ุงูุชุฎุตูุต

### ุชุบููุฑ ูุฏุฉ ุงูุชุญุฏูุซ ุงูุชููุงุฆู:

ูู `NotificationBell.tsx` ุงูุณุทุฑ 119:

```typescript
// ูู 30 ุซุงููุฉ
const interval = setInterval(fetchUnreadCount, 30000);

// ุฅูู 60 ุซุงููุฉ
const interval = setInterval(fetchUnreadCount, 60000);
```

### ุชุบููุฑ ุนุฏุฏ ุงูุฅุดุนุงุฑุงุช ุงููุนุฑูุถุฉ:

ูู `NotificationBell.tsx` ุงูุณุทุฑ 38:

```typescript
// ูู 20 ุฅุดุนุงุฑ
const response = await notificationService.getNotifications({ per_page: 20 });

// ุฅูู 50 ุฅุดุนุงุฑ
const response = await notificationService.getNotifications({ per_page: 50 });
```

### ุชุบููุฑ ูููุน ุงููุงุฆูุฉ:

ูู `NotificationBell.tsx` ุงูุณุทุฑ 174:

```typescript
// ูู ุงููุณุงุฑ
<div className="absolute left-0 mt-2 ...">

// ุฅูู ุงููููู
<div className="absolute right-0 mt-2 ...">
```

---

## ๐ ุฃูุซูุฉ ุงุณุชุฎุฏุงู

### ูุซุงู 1: ุฅุดุนุงุฑ ุนูุฏ ุฅูุดุงุก ุชุฐูุฑุฉ

```typescript
// ูู TicketController.js ุจุนุฏ ุฅูุดุงุก ุงูุชุฐูุฑุฉ
await notificationService.createNotification({
  user_id: ticket.assigned_to,
  title: 'ุชุฐูุฑุฉ ุฌุฏูุฏุฉ ููุณูุฏุฉ ูู',
  message: `ุชู ุฅุณูุงุฏ ุงูุชุฐูุฑุฉ ${ticket.ticket_number} ูู`,
  type: 'info',
  data: {
    ticket_id: ticket.id,
    ticket_number: ticket.ticket_number
  }
});
```

### ูุซุงู 2: ุฅุดุนุงุฑ ุนูุฏ ุชุญุฑูู ุชุฐูุฑุฉ

```typescript
// ูู ticket move handler
await notificationService.createNotification({
  user_id: ticket.assigned_to,
  title: 'ุชู ุชุญุฑูู ุชุฐูุฑุฉ',
  message: `ุชู ุชุญุฑูู ุงูุชุฐูุฑุฉ ${ticket.ticket_number} ุฅูู ูุฑุญูุฉ ${newStage.name}`,
  type: 'success',
  data: {
    ticket_id: ticket.id,
    old_stage: oldStage.name,
    new_stage: newStage.name
  }
});
```

### ูุซุงู 3: ุฅุดุนุงุฑ ุฌูุงุนู ููุฑูู

```typescript
// ุฅุดุนุงุฑ ูุฌููุน ุฃุนุถุงุก ุงููุฑูู
const teamMembers = await getTeamMembers(teamId);
const userIds = teamMembers.map(m => m.id);

await notificationService.sendBulkNotification({
  user_ids: userIds,
  title: 'ุงุฌุชูุงุน ูุฑูู',
  message: 'ุงุฌุชูุงุน ูุฑูู ุบุฏุงู ุงูุณุงุนุฉ 10 ุตุจุงุญุงู',
  type: 'warning'
});
```

---

## ๐ ุงูุฅุญุตุงุฆูุงุช

ุงููุธุงู ูุฏุนู:
- โ **8 API endpoints** ูุงููุฉ
- โ **4 ุฃููุงุน** ูู ุงูุฅุดุนุงุฑุงุช
- โ **ุชุญุฏูุซ ุชููุงุฆู** ูู 30 ุซุงููุฉ
- โ **ุฅุดุนุงุฑุงุช ุฌูุงุนูุฉ** ูุนุฏุฉ ูุณุชุฎุฏููู
- โ **ุชุตููุฉ** ุญุณุจ ุงูููุน ูุงูุญุงูุฉ
- โ **pagination** ููุฅุดุนุงุฑุงุช ุงููุซูุฑุฉ

---

## ๐ ุงูุฎูุงุตุฉ

### ุชู ุชุทุจูู:
- โ ุฌููุน ุงูู 8 API endpoints
- โ Service ูุงูู ููู Frontend
- โ ูููู NotificationBell ุฌููู
- โ ุฅุถุงูุฉ ุงูุฃููููุฉ ูู Header
- โ ุฌููุน ุงูููุฒุงุช ุงููุทููุจุฉ

### ุงููุชูุฌุฉ:
**ูุธุงู ุฅุดุนุงุฑุงุช ูุชูุงูู ูุฌุงูุฒ ููุงุณุชุฎุฏุงู! ๐**

---

**ุฃุนุฏ ุชุญููู ุงูุตูุญุฉ ูุฌุฑุจ ุงูุขู! ๐**
