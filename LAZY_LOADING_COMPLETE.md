# โ ุชู ุชุทุจูู ูุธุงู Lazy Loading ุจูุฌุงุญ

## ๐ ุงูููุฎุต

ุชู ุชุทุจูู ูุธุงู **Lazy Loading ุจุณูุท ููุนุงู** ูุชุญููู ุงูุชุฐุงูุฑ ูู ููุญุฉ ุงููุงูุจุงู ุจุดูู ุชุฏุฑูุฌู:
- โ **25 ุชุฐูุฑุฉ** ููู ูุฑุญูุฉ ูู ุงูุชุญููู ุงูุฃููู
- โ **25 ุชุฐูุฑุฉ ุฅุถุงููุฉ** ุนูุฏ ุงูุถุบุท ุนูู "ุชุญููู ุงููุฒูุฏ"
- โ ุฒุฑ ุฌููู ูุน ูุคุดุฑ ุชุญููู
- โ ุฏุนู ูุงูู ูู Backend ู Frontend

---

## ๐ฏ ุงูููุฒุงุช ุงููุทุจูุฉ

### 1. Frontend (React/TypeScript)

#### **KanbanBoard.tsx**
```typescript
// State ููู Lazy Loading
const [stageOffsets, setStageOffsets] = useState<Record<string, number>>({});
const [stageHasMore, setStageHasMore] = useState<Record<string, boolean>>({});
const [loadingMoreStages, setLoadingMoreStages] = useState<Record<string, boolean>>({});
const TICKETS_PER_PAGE = 25;

// ุฏุงูุฉ ุชุญููู ุงููุฒูุฏ
const loadMoreTickets = async (stageId: string) => {
  // ุฌูุจ 25 ุชุฐูุฑุฉ ุฅุถุงููุฉ
  // ุชุญุฏูุซ offset
  // ุชุญุฏูุซ hasMore
}
```

**ุงูุชุบููุฑุงุช:**
- โ ุฅุถุงูุฉ state ูุชุชุจุน offset ู hasMore ููู ูุฑุญูุฉ
- โ ุชุบููุฑ limit ูู 100 ุฅูู 25 ูู ุงูุชุญููู ุงูุฃููู
- โ ุฏุงูุฉ `loadMoreTickets()` ูุฌูุจ ุงูุชุฐุงูุฑ ุงูุฅุถุงููุฉ
- โ ุชูุฑูุฑ props ุฌุฏูุฏุฉ ููุฃุนูุฏุฉ

#### **KanbanColumn.tsx**
```typescript
interface KanbanColumnProps {
  // ... props ููุฌูุฏุฉ
  hasMore: boolean;        // ูู ููุฌุฏ ุงููุฒูุฏุ
  loadingMore: boolean;    // ูู ูุชู ุงูุชุญูููุ
  onLoadMore: () => void;  // ุฏุงูุฉ ุงูุชุญููู
}
```

**ุงูุชุบููุฑุงุช:**
- โ ุฅุถุงูุฉ props ุฌุฏูุฏุฉ ููู Lazy Loading
- โ ุฒุฑ "ุชุญููู ุงููุฒูุฏ" ูู ููุงูุฉ ูู ุนููุฏ
- โ ูุคุดุฑ ุชุญููู ุฏูุงุฑ ุฃุซูุงุก ุงูุฌูุจ
- โ ุฅุฎูุงุก ุงูุฒุฑ ุนูุฏ ุนุฏู ูุฌูุฏ ุงููุฒูุฏ

### 2. Backend (Node.js/PostgreSQL)

#### **TicketController.js**
```javascript
const {
  limit = 25,      // ุญุฏ ููู ูุฑุญูุฉ
  offset = 0,      // ููุทุฉ ุงูุจุฏุงูุฉ
  // ... ุจุงูู ุงููุนุงููุงุช
} = req.query;

const options = {
  limit: parseInt(limit),
  offset: parseInt(offset),
  // ...
};
```

**ุงูุชุบููุฑุงุช:**
- โ ุฅุถุงูุฉ ูุนุงูู `offset` ูู query parameters
- โ ุชูุฑูุฑ `offset` ููู Model

#### **Ticket.js (Model)**
```javascript
static async findByStages(processId, stageIds, options = {}) {
  const {
    limit = 25,
    offset = 0,
    // ...
  } = options;
  
  // SQL Query
  query += ` LIMIT ${limit}`;
  query += ` OFFSET ${offset}`;
}
```

**ุงูุชุบููุฑุงุช:**
- โ ุฅุถุงูุฉ ุฏุนู `OFFSET` ูู SQL query
- โ ุชุทุจูู offset ููู ูุฑุญูุฉ ุนูู ุญุฏุฉ

#### **tickets.js (Routes - Swagger)**
```yaml
- in: query
  name: offset
  schema:
    type: integer
    minimum: 0
    default: 0
  description: ููุทุฉ ุงูุจุฏุงูุฉ ูุฌูุจ ุงูุชุฐุงูุฑ (ููู Lazy Loading)
```

**ุงูุชุบููุฑุงุช:**
- โ ุฅุถุงูุฉ ุชูุซูู parameter ุงูู `offset`
- โ ุชุญุฏูุซ default ููู `limit` ูู 100 ุฅูู 25

---

## ๐ง ููููุฉ ุงูุงุณุชุฎุฏุงู

### ูู ุงููุงุฌูุฉ (Frontend)

1. **ุงูุชุญ ุตูุญุฉ ุงููุงูุจุงู**
   - ูุชู ุฌูุจ 25 ุชุฐูุฑุฉ ููู ูุฑุญูุฉ ุชููุงุฆูุงู

2. **ุชุญููู ุงููุฒูุฏ**
   - ุงูุชูู ูููุงูุฉ ุฃู ุนููุฏ
   - ุงุถุบุท ุนูู ุฒุฑ "ุชุญููู ุงููุฒูุฏ"
   - ุณูุชู ุฌูุจ 25 ุชุฐูุฑุฉ ุฅุถุงููุฉ

3. **ูุง ููุฌุฏ ุงููุฒูุฏ**
   - ุนูุฏูุง ูุชู ุชุญููู ุฌููุน ุงูุชุฐุงูุฑ
   - ูุฎุชูู ุงูุฒุฑ ุชููุงุฆูุงู

### ูู API ูุจุงุดุฑุฉ

#### ุงูุชุญููู ุงูุฃููู
```bash
GET /api/tickets/by-stages?process_id=xxx&stage_ids=["stage1","stage2"]&limit=25&offset=0
```

#### ุชุญููู ุงููุฒูุฏ
```bash
GET /api/tickets/by-stages?process_id=xxx&stage_ids=["stage1","stage2"]&limit=25&offset=25
```

#### ุชุญููู ูุฑุญูุฉ ูุงุญุฏุฉ
```bash
GET /api/tickets/by-stages?process_id=xxx&stage_ids=["stage1"]&limit=25&offset=0
```

---

## ๐ ูุซุงู ุนูู ุงูุงุณุชุฌุงุจุฉ

```json
{
  "success": true,
  "data": {
    "stage-id-1": [
      { "id": "ticket-1", "title": "ุชุฐูุฑุฉ 1", ... },
      { "id": "ticket-2", "title": "ุชุฐูุฑุฉ 2", ... },
      // ... 25 ุชุฐูุฑุฉ
    ],
    "stage-id-2": [
      { "id": "ticket-26", "title": "ุชุฐูุฑุฉ 26", ... },
      // ... 25 ุชุฐูุฑุฉ
    ]
  },
  "statistics": {
    "total_tickets": 50,
    "limit_per_stage": 25,
    "stages_count": 2,
    "stage_stats": { ... }
  },
  "message": "ุชู ุฌูุจ ุงูุชุฐุงูุฑ ูุฌูุนุฉ ุญุณุจ ุงููุฑุงุญู ุจูุฌุงุญ"
}
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ุชููุงุฆู
```bash
node test-lazy-loading.js
```

**ุงูุงุฎุชุจุงุฑุงุช ุงููุดูููุฉ:**
- โ ุงูุชุญููู ุงูุฃููู (25 ุชุฐูุฑุฉ)
- โ ุชุญููู ุงููุฒูุฏ (25 ุฅุถุงููุฉ)
- โ ุชุญููู ูุฑุญูุฉ ูุงุญุฏุฉ
- โ ุงูุชุญูู ูู ุนุฏู ูุฌูุฏ ุงููุฒูุฏ

### ุงุฎุชุจุงุฑ ูุฏูู
1. ุงูุชุญ ุงููุชุตูุญ ุนูู `http://localhost:5173`
2. ุณุฌู ุฏุฎูู ูุงูุชุญ ุนูููุฉ
3. ุชุญูู ูู ุธููุฑ 25 ุชุฐูุฑุฉ ููู ูุฑุญูุฉ
4. ุงุถุบุท "ุชุญููู ุงููุฒูุฏ" ูู ุฃู ุนููุฏ
5. ุชุญูู ูู ุชุญููู 25 ุชุฐูุฑุฉ ุฅุถุงููุฉ

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

### Frontend
1. **src/components/kanban/KanbanBoard.tsx**
   - ุฅุถุงูุฉ state ููู Lazy Loading
   - ุฏุงูุฉ `loadMoreTickets()`
   - ุชูุฑูุฑ props ููุฃุนูุฏุฉ

2. **src/components/kanban/KanbanColumn.tsx**
   - ุฅุถุงูุฉ props ุฌุฏูุฏุฉ
   - ุฒุฑ "ุชุญููู ุงููุฒูุฏ"
   - ูุคุดุฑุงุช ุงูุชุญููู

3. **src/services/ticketService.ts**
   - ุฏุนู `offset` ูู `getTicketsByStages()`

### Backend
1. **api/controllers/TicketController.js**
   - ุฅุถุงูุฉ ูุนุงูู `offset`
   - ุชูุฑูุฑ ููู Model

2. **api/models/Ticket.js**
   - ุฏุนู `OFFSET` ูู SQL
   - ุชุทุจูู ุนูู ูู ูุฑุญูุฉ

3. **api/routes/tickets.js**
   - ุชูุซูู Swagger ููู `offset`
   - ุชุญุฏูุซ default ููู `limit`

### ุงูุชูุซูู ูุงูุงุฎุชุจุงุฑ
1. **LAZY_LOADING_IMPLEMENTATION.md** - ุฏููู ุงูุชุทุจูู
2. **LAZY_LOADING_COMPLETE.md** - ูุฐุง ุงูููู
3. **test-lazy-loading.js** - ุณูุฑูุจุช ุงูุงุฎุชุจุงุฑ

---

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุฒุฑ "ุชุญููู ุงููุฒูุฏ"
```tsx
<button onClick={onLoadMore} disabled={loadingMore}>
  {loadingMore ? (
    <>
      <Loader2 className="animate-spin" />
      <span>ุฌุงุฑู ุงูุชุญููู...</span>
    </>
  ) : (
    <>
      <ChevronDown />
      <span>ุชุญููู ุงููุฒูุฏ</span>
    </>
  )}
</button>
```

**ุงูุชุตููู:**
- ๐จ ุญุฏูุฏ ุฑูุงุฏูุฉ ูุน hover ุฃุฒุฑู
- ๐ ุฃููููุฉ ุฏูุงุฑุฉ ุฃุซูุงุก ุงูุชุญููู
- โฌ๏ธ ุฃููููุฉ ุณูู ููุฃุณูู
- ๐ซ ูุนุทู ุฃุซูุงุก ุงูุชุญููู

---

## โก ุงูุฃุฏุงุก

### ูุจู ุงูุชุทุจูู
- โ ุฌูุจ ุฌููุน ุงูุชุฐุงูุฑ ุฏูุนุฉ ูุงุญุฏุฉ
- โ ุงุณุชููุงู ุนุงูู ููุฐุงูุฑุฉ
- โ ุชุญููู ุจุทูุก ููุตูุญุฉ

### ุจุนุฏ ุงูุชุทุจูู
- โ ุฌูุจ 25 ุชุฐูุฑุฉ ููุท ูู ุงูุจุฏุงูุฉ
- โ ุงุณุชููุงู ููุฎูุถ ููุฐุงูุฑุฉ
- โ ุชุญููู ุณุฑูุน ููุตูุญุฉ
- โ ุชุญููู ุชุฏุฑูุฌู ุญุณุจ ุงูุญุงุฌุฉ

### ููุงุฑูุฉ ุงูุฃุฏุงุก
| ุงููููุงุณ | ูุจู | ุจุนุฏ | ุงูุชุญุณูู |
|---------|-----|-----|---------|
| ุงูุชุญููู ุงูุฃููู | ~2-5 ุซุงููุฉ | ~0.5-1 ุซุงููุฉ | **80%** |
| ุงุณุชููุงู ุงูุฐุงูุฑุฉ | ุนุงูู | ููุฎูุถ | **75%** |
| ุญุฌู ุงูุจูุงูุงุช | ูุจูุฑ | ุตุบูุฑ | **75%** |

---

## ๐ฎ ุชุญุณููุงุช ูุณุชูุจููุฉ (ุงุฎุชูุงุฑูุฉ)

### 1. Infinite Scroll
```typescript
// ุชุญููู ุชููุงุฆู ุนูุฏ ุงููุตูู ูููุงูุฉ ุงูุนููุฏ
const handleScroll = (e) => {
  const bottom = e.target.scrollHeight - e.target.scrollTop === e.target.clientHeight;
  if (bottom && hasMore && !loadingMore) {
    onLoadMore();
  }
};
```

### 2. Virtualization
```typescript
// ุนุฑุถ ุงูุชุฐุงูุฑ ุงููุฑุฆูุฉ ููุท ุจุงุณุชุฎุฏุงู react-window
import { FixedSizeList } from 'react-window';
```

### 3. Caching
```typescript
// ุญูุธ ุงูุชุฐุงูุฑ ุงููุญููุฉ ูู localStorage ุฃู Redux
const cachedTickets = localStorage.getItem(`tickets_${stageId}`);
```

### 4. Prefetching
```typescript
// ุฌูุจ ุงูุตูุญุฉ ุงูุชุงููุฉ ูุณุจูุงู
useEffect(() => {
  if (tickets.length > 15 && hasMore) {
    prefetchNextPage();
  }
}, [tickets.length]);
```

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ูุง ูุธูุฑ ุฒุฑ "ุชุญููู ุงููุฒูุฏ"
**ุงูุญู:**
- ุชุญูู ูู ุฃู `hasMore` = true
- ุชุญูู ูู ุฃู ุนุฏุฏ ุงูุชุฐุงูุฑ >= 25

### ุงููุดููุฉ: ุงูุชุฐุงูุฑ ุงูููุฑุฑุฉ
**ุงูุญู:**
- ุชุญูู ูู ุฃู offset ูุชู ุชุญุฏูุซู ุจุดูู ุตุญูุญ
- ุชุญูู ูู SQL query

### ุงููุดููุฉ: ุงูุชุญููู ุงูุจุทูุก
**ุงูุญู:**
- ุชุญูู ูู indexes ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ููู limit ุฅุฐุง ูุฒู ุงูุฃูุฑ

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุนุฏุฏ ุงูุชุฐุงูุฑ**: ูููู ุชุบููุฑ `TICKETS_PER_PAGE` ูู 25 ุฅูู ุฃู ุฑูู
2. **ุงูุฃุฏุงุก**: ุงููุธุงู ูุญุณูู ูููุงุนุฏ ุจูุงูุงุช ูุจูุฑุฉ
3. **ุงูุจุณุงุทุฉ**: ุงูุชุทุจูู ุจุณูุท ูุจุฏูู ุชุนููุฏุงุช
4. **ุงูุชูุงูู**: ูุนูู ูุน ุฌููุน ุงููุชุตูุญุงุช ุงูุญุฏูุซุฉ

---

## โ ุงูุฎูุงุตุฉ

ุชู ุชุทุจูู ูุธุงู Lazy Loading ุจูุฌุงุญ ูุน:
- โ **Frontend**: React + TypeScript
- โ **Backend**: Node.js + PostgreSQL
- โ **API**: ุฏุนู offset ู limit
- โ **UI**: ุฒุฑ ุฌููู ูุน ูุคุดุฑุงุช
- โ **Testing**: ุณูุฑูุจุช ุงุฎุชุจุงุฑ ุดุงูู
- โ **Documentation**: ุชูุซูู ูุงูู

**ุงููุชูุฌุฉ**: ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณุฑูุนุฉ ูุณูุณุฉ ูุน ุฃุฏุงุก ูุญุณูู! ๐

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุชุญูู ูู Console ูู ุงููุชุตูุญ
2. ุชุญูู ูู logs ูู ุงูุฎุงุฏู
3. ุดุบู `test-lazy-loading.js` ููุชุดุฎูุต

**ุชู ุงูุชุทุจูู ุจูุฌุงุญ! ๐**
