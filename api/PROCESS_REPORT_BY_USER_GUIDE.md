# ุฏููู ุงุณุชุฎุฏุงู ุชูุฑูุฑ ุงูุนูููุฉ ูุฌูุน ุญุณุจ ุงููุณุชุฎุฏู

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅูุดุงุก endpoint ุฌุฏูุฏ ูุนุทู ููุณ ุจูุงูุงุช ุชูุฑูุฑ ุงูุนูููุฉ ุงูุดุงูู ูููู **ูุฌูุนุฉ ุญุณุจ ุงููุณุชุฎุฏู ุงูููุณูุฏ ูู ุงูุชุฐุงูุฑ**.

## ๐ Endpoint

```
GET /api/reports/process/{process_id}/by-user
```

## ๐ ุงููุตุงุฏูุฉ

ูุชุทูุจ ูุฐุง ุงูู endpoint ูุตุงุฏูุฉ ุจุงุณุชุฎุฏุงู Bearer Token:

```
Authorization: Bearer {your_token}
```

## ๐ฅ ุงููุนุงููุงุช (Parameters)

### Path Parameters
- **process_id** (ูุทููุจ): ูุนุฑู ุงูุนูููุฉ (UUID)

### Query Parameters
- **date_from** (ุงุฎุชูุงุฑู): ุชุงุฑูุฎ ุงูุจุฏุงูุฉ (ISO 8601 format)
  - ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ: ุขุฎุฑ 30 ููู
- **date_to** (ุงุฎุชูุงุฑู): ุชุงุฑูุฎ ุงูููุงูุฉ (ISO 8601 format)
  - ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ: ุงูููู

## ๐ค ูุซุงู ุนูู ุงูุทูุจ

```bash
curl -X GET "http://localhost:3000/api/reports/process/d6f7574c-d937-4e55-8cb1-0b19269e6061/by-user?date_from=2025-09-17T00:49:51.726Z&date_to=2025-10-17T00:49:51.726Z" \
  -H "Authorization: Bearer YOUR_TOKEN"
```

## ๐ ูููู ุงูุงุณุชุฌุงุจุฉ

```json
{
  "success": true,
  "data": {
    "process": {
      "id": "d6f7574c-d937-4e55-8cb1-0b19269e6061",
      "name": "ุนูููุฉ ุฌุฏูุฏุฉ ุงุตุฏุงุฑ ุซุงูู",
      "description": "ุนูููุฉ ุฌุฏูุฏุฉ ุงุตุฏุงุฑ ุซุงูู",
      "color": "bg-blue-500",
      "icon": "FolderOpen",
      "is_active": true
    },
    "period": {
      "from": "2025-09-17T00:49:51.726Z",
      "to": "2025-10-17T00:49:51.726Z"
    },
    "user_reports": [
      {
        "user": {
          "id": "user-uuid",
          "name": "ุงุณู ุงููุณุชุฎุฏู",
          "email": "user@example.com"
        },
        "basic_stats": {
          "total_tickets": "50",
          "active_tickets": "30",
          "completed_tickets": "20",
          "cancelled_tickets": "0",
          "archived_tickets": "0",
          "overdue_tickets": "5"
        },
        "stage_distribution": [
          {
            "stage_id": "stage-uuid",
            "stage_name": "ูุฑุญูุฉ ุฌุฏูุฏุฉ",
            "stage_color": "#6B7280",
            "order_index": 1,
            "is_initial": true,
            "is_final": false,
            "ticket_count": "25",
            "percentage": "50.00"
          }
        ],
        "overdue_by_stage": [
          {
            "stage_id": "stage-uuid",
            "stage_name": "ูุฑุญูุฉ ุฌุฏูุฏุฉ",
            "stage_color": "#6B7280",
            "overdue_count": "3",
            "overdue_percentage": "6.00",
            "avg_days_overdue": "2.50"
          }
        ],
        "priority_distribution": [
          {
            "priority": "urgent",
            "count": "5",
            "percentage": "10.00"
          },
          {
            "priority": "high",
            "count": "10",
            "percentage": "20.00"
          },
          {
            "priority": "medium",
            "count": "30",
            "percentage": "60.00"
          },
          {
            "priority": "low",
            "count": "5",
            "percentage": "10.00"
          }
        ],
        "completion_rate": {
          "completed_count": "20",
          "on_time_count": "15",
          "late_count": "5",
          "avg_completion_days": "3.50",
          "on_time_percentage": "75.00"
        },
        "recent_tickets": [
          {
            "id": "ticket-uuid",
            "ticket_number": "ุนูู-000004-1760651395135-4713",
            "title": "ุนููุงู ุงูุชุฐูุฑุฉ",
            "priority": "high",
            "status": "active",
            "created_at": "2025-10-16T21:49:55.129Z",
            "due_date": "2025-10-20T21:49:00.000Z",
            "completed_at": null,
            "stage_name": "ูุฑุญูุฉ ุฌุฏูุฏุฉ",
            "stage_color": "#6B7280",
            "is_overdue": false
          }
        ],
        "performance_metrics": {
          "net_performance_hours": "120.50"
        },
        "completed_tickets_details": [
          {
            "id": "ticket-uuid",
            "ticket_number": "ุนูู-000004-1760651395135-4713",
            "title": "ุนููุงู ุงูุชุฐูุฑุฉ",
            "priority": "high",
            "created_at": "2025-10-16T21:49:55.129Z",
            "due_date": "2025-10-20T21:49:00.000Z",
            "completed_at": "2025-10-16T21:50:01.897Z",
            "stage_name": "ููุชููุฉ",
            "variance_hours": "95.98",
            "performance_status": "early"
          }
        ]
      }
    ]
  }
}
```

## ๐ ูุตู ุงูุญููู

### user_reports (ูุตูููุฉ)
ูู ุนูุตุฑ ูู ุงููุตูููุฉ ููุซู ุชูุฑูุฑ ูุณุชุฎุฏู ูุงุญุฏ ููุญุชูู ุนูู:

#### 1. user (ูุนูููุงุช ุงููุณุชุฎุฏู)
- **id**: ูุนุฑู ุงููุณุชุฎุฏู
- **name**: ุงุณู ุงููุณุชุฎุฏู
- **email**: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู

#### 2. basic_stats (ุงูุฅุญุตุงุฆูุงุช ุงูุฃุณุงุณูุฉ)
- **total_tickets**: ุฅุฌูุงูู ุงูุชุฐุงูุฑ ุงูููุณูุฏุฉ ูููุณุชุฎุฏู
- **active_tickets**: ุงูุชุฐุงูุฑ ุงููุดุทุฉ
- **completed_tickets**: ุงูุชุฐุงูุฑ ุงูููุชููุฉ
- **cancelled_tickets**: ุงูุชุฐุงูุฑ ุงูููุบุงุฉ
- **archived_tickets**: ุงูุชุฐุงูุฑ ุงููุคุฑุดูุฉ
- **overdue_tickets**: ุงูุชุฐุงูุฑ ุงููุชุฃุฎุฑุฉ

#### 3. stage_distribution (ุชูุฒูุน ุงูุชุฐุงูุฑ ุนูู ุงููุฑุงุญู)
- **stage_id**: ูุนุฑู ุงููุฑุญูุฉ
- **stage_name**: ุงุณู ุงููุฑุญูุฉ
- **stage_color**: ููู ุงููุฑุญูุฉ
- **order_index**: ุชุฑุชูุจ ุงููุฑุญูุฉ
- **is_initial**: ูู ูู ุงููุฑุญูุฉ ุงูุฃููู
- **is_final**: ูู ูู ุงููุฑุญูุฉ ุงูููุงุฆูุฉ
- **ticket_count**: ุนุฏุฏ ุงูุชุฐุงูุฑ ูู ูุฐู ุงููุฑุญูุฉ
- **percentage**: ุงููุณุจุฉ ุงููุฆููุฉ

#### 4. overdue_by_stage (ุงูุชุฐุงูุฑ ุงููุชุฃุฎุฑุฉ ุญุณุจ ุงููุฑุญูุฉ)
- **stage_id**: ูุนุฑู ุงููุฑุญูุฉ
- **stage_name**: ุงุณู ุงููุฑุญูุฉ
- **stage_color**: ููู ุงููุฑุญูุฉ
- **overdue_count**: ุนุฏุฏ ุงูุชุฐุงูุฑ ุงููุชุฃุฎุฑุฉ
- **overdue_percentage**: ุงููุณุจุฉ ุงููุฆููุฉ ููุชุฃุฎูุฑ
- **avg_days_overdue**: ูุชูุณุท ุฃูุงู ุงูุชุฃุฎูุฑ

#### 5. priority_distribution (ุชูุฒูุน ุญุณุจ ุงูุฃููููุฉ)
- **priority**: ุงูุฃููููุฉ (urgent, high, medium, low)
- **count**: ุนุฏุฏ ุงูุชุฐุงูุฑ
- **percentage**: ุงููุณุจุฉ ุงููุฆููุฉ

#### 6. completion_rate (ูุนุฏู ุงูุฅูุฌุงุฒ)
- **completed_count**: ุนุฏุฏ ุงูุชุฐุงูุฑ ุงูููุชููุฉ
- **on_time_count**: ุนุฏุฏ ุงูุชุฐุงูุฑ ุงูููุชููุฉ ูู ุงูููุช ุงููุญุฏุฏ
- **late_count**: ุนุฏุฏ ุงูุชุฐุงูุฑ ุงูููุชููุฉ ูุชุฃุฎุฑุฉ
- **avg_completion_days**: ูุชูุณุท ุฃูุงู ุงูุฅูุฌุงุฒ
- **on_time_percentage**: ูุณุจุฉ ุงูุฅูุฌุงุฒ ูู ุงูููุช ุงููุญุฏุฏ

#### 7. recent_tickets (ุฃุญุฏุซ ุงูุชุฐุงูุฑ)
ุขุฎุฑ 10 ุชุฐุงูุฑ ูููุณุชุฎุฏู ูู ูุฐู ุงูุนูููุฉ

#### 8. performance_metrics (ูุคุดุฑุงุช ุงูุฃุฏุงุก)
- **net_performance_hours**: ุตุงูู ุงูุฃุฏุงุก ุจุงูุณุงุนุงุช (ููุฌุจ = ูุจูุฑุ ุณุงูุจ = ูุชุฃุฎุฑ)

#### 9. completed_tickets_details (ุชูุงุตูู ุงูุชุฐุงูุฑ ุงูููุชููุฉ)
ุชูุงุตูู ุฌููุน ุงูุชุฐุงูุฑ ุงูููุชููุฉ ูุน:
- **variance_hours**: ุงููุงุฑู ุจุงูุณุงุนุงุช ุจูู ุงูุฅูุฌุงุฒ ูุงูููุนุฏ ุงููุญุฏุฏ
- **performance_status**: ุญุงูุฉ ุงูุฃุฏุงุก (early, on_time, late)

## ๐ฏ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู

### 1. ุชูููู ุฃุฏุงุก ุงูููุธููู
ุงุณุชุฎุฏู ูุฐุง ุงูุชูุฑูุฑ ููุนุฑูุฉ ุฃุฏุงุก ูู ููุธู ูู ุนูููุฉ ูุนููุฉ:
- ูู ุชุฐูุฑุฉ ุฃูุฌุฒุ
- ูู ููุฌุฒ ูู ุงูููุช ุงููุญุฏุฏุ
- ูุง ูู ุงููุฑุงุญู ุงูุชู ูุชุฃุฎุฑ ูููุงุ

### 2. ุชูุฒูุน ุงูุนูู
ุชุญููู ุชูุฒูุน ุงูุชุฐุงูุฑ ุจูู ุงูููุธููู:
- ูู ูุฏูู ุฃูุซุฑ ุชุฐุงูุฑ ูุดุทุฉุ
- ูู ูุฏูู ุชุฐุงูุฑ ูุชุฃุฎุฑุฉุ
- ูู ูุญุชุงุฌ ุฅูู ูุณุงุนุฏุฉุ

### 3. ุชูุงุฑูุฑ ุงูุฃุฏุงุก ุงูุดูุฑูุฉ
ุฅูุดุงุก ุชูุงุฑูุฑ ุดูุฑูุฉ ููู ููุธู ุชุชุถูู:
- ุงูุฅุญุตุงุฆูุงุช ุงูุฃุณุงุณูุฉ
- ูุนุฏู ุงูุฅูุฌุงุฒ
- ูุคุดุฑุงุช ุงูุฃุฏุงุก

## ๐ ุงููุฑู ุจูู ุงูุชูุฑูุฑูู

### ุงูุชูุฑูุฑ ุงูุนุงุฏู (`/process/:process_id`)
ูุนุทู ุฅุญุตุงุฆูุงุช ุดุงููุฉ ููุนูููุฉ ููู ูุน ูุงุฆูุฉ ุจุฃูุถู ุงูููุธููู ุฃุฏุงุกู.

### ุงูุชูุฑูุฑ ุงููุฌูุน ุญุณุจ ุงููุณุชุฎุฏู (`/process/:process_id/by-user`)
ูุนุทู ููุณ ุงูุฅุญุตุงุฆูุงุช ูููู **ููุตูุฉ ููู ูุณุชุฎุฏู ุนูู ุญุฏุฉ**ุ ููุง ูุณูู:
- ููุงุฑูุฉ ุฃุฏุงุก ุงูููุธููู
- ุชุญุฏูุฏ ููุงุท ุงูููุฉ ูุงูุถุนู ููู ููุธู
- ุฅูุดุงุก ุชูุงุฑูุฑ ูุฑุฏูุฉ

## ๐งช ุงูุงุฎุชุจุงุฑ

ูุงุฎุชุจุงุฑ ุงูู endpoint:

```bash
# 1. ุดุบู ุงูุณูุฑูุฑ
cd api
npm start

# 2. ูู terminal ุขุฎุฑุ ุดุบู ููู ุงูุงุฎุชุจุงุฑ
node test-process-report-by-user.js
```

ุณูููู ููู ุงูุงุฎุชุจุงุฑ ุจู:
1. ุชุณุฌูู ุงูุฏุฎูู
2. ุฌูุจ ุงูุชูุฑูุฑ
3. ุนุฑุถ ุงููุชุงุฆุฌ ุจุดูู ููุณู
4. ุญูุธ ุงููุชุงุฆุฌ ุงููุงููุฉ ูู `process-report-by-user-result.json`

## ๐ ุงููููุงุช ุงููุชุฃุซุฑุฉ

1. **controllers/ReportController.js**
   - ุฅุถุงูุฉ ุฏุงูุฉ `getProcessDetailedReportByUser`

2. **routes/reports.js**
   - ุฅุถุงูุฉ route ุฌุฏูุฏ ูุน ุชูุซูู Swagger

3. **test-process-report-by-user.js**
   - ููู ุงุฎุชุจุงุฑ ุดุงูู

4. **PROCESS_REPORT_BY_USER_GUIDE.md**
   - ูุฐุง ุงูุฏููู

## โ ุงูููุฒุงุช

- โ ุจุณูุท ููุจุงุดุฑ - ูุง ุชุนููุฏุงุช
- โ ููุณ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ูููู ูุฌูุนุฉ ุญุณุจ ุงููุณุชุฎุฏู
- โ ุชูุซูู Swagger ูุงูู
- โ ูุนุงูุฌุฉ ุฃุฎุทุงุก ุดุงููุฉ
- โ ุฏุนู ุงููุชุฑุงุช ุงูุฒูููุฉ ุงููุฎุตุตุฉ
- โ ูุนูู ูุน ุงูุชุฐุงูุฑ ุบูุฑ ุงูููุณูุฏุฉ (assigned_to = null)

## ๐ ุงููุชูุฌุฉ

ุงูุขู ููููู ุงูุญุตูู ุนูู ุชูุฑูุฑ ุดุงูู ูุฃู ุนูููุฉ ููุณู ุญุณุจ ูู ูุณุชุฎุฏูุ ููุง ูุณูู:
- ุชูููู ุงูุฃุฏุงุก ุงููุฑุฏู
- ููุงุฑูุฉ ุงูููุธููู
- ุชุญุฏูุฏ ุงูุงุญุชูุงุฌุงุช ุงูุชุฏุฑูุจูุฉ
- ุชูุฒูุน ุงูุนูู ุจุดูู ุฃูุถู
