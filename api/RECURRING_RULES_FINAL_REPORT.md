# ุชูุฑูุฑ ุฅูุดุงุก ุฌุฏูู recurring_rules - ุงูููุงุฆู

## ๐ฏ ุงููุทููุจ ุงููุญูู

โ **ุฅูุดุงุก ุงูุฌุฏูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช**  
โ **ุนูู ููู SQL**  
โ **ุงูุชุญูู ูู ุนูููุฉ ุงูุฅูุดุงุก**  

## ๐ ูุง ุชู ุฅูุฌุงุฒู

### 1. ุฅูุดุงุก ููู SQL โ
- **ุงูููู**: `create-recurring-rules-table.sql`
- **ุงููุญุชูู**: ุฌุฏูู ูุงูู ูุน 36 ุญูู
- **ุงูููุฒุงุช**: 
  - ูููุฏ ุงููุฑุฌุนูุฉ (Foreign Keys)
  - ููุงุฑุณ ูุญุณูุฉ ููุฃุฏุงุก (8 ููุงุฑุณ)
  - Triggers ุชููุงุฆูุฉ ูู updated_at
  - ุชุนูููุงุช ุชูุถูุญูุฉ

### 2. ุฅูุดุงุก ุงูุฌุฏูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช โ
- **ุงูุฌุฏูู**: `recurring_rules`
- **ุนุฏุฏ ุงูุญููู**: 36 ุญูู
- **ุนุฏุฏ ุงูููุงุฑุณ**: 8 ููุงุฑุณ
- **ุนุฏุฏ ุงูู Triggers**: 1 trigger

#### ุงูุญููู ุงูุฃุณุงุณูุฉ ุงููุทููุจุฉ:
```sql
โ id (UUID) - ูุนุฑู ูุฑูุฏ
โ name (VARCHAR) - ุงุณู ุงููุงุนุฏุฉ (ูุทููุจ)
โ rule_name (VARCHAR) - ุงุณู ุงููุงุนุฏุฉ ุงูุจุฏูู
โ rule_description (TEXT) - ูุตู ุงููุงุนุฏุฉ
โ title (VARCHAR) - ุนููุงู ุงูุชุฐูุฑุฉ (ูุทููุจ)
โ description (TEXT) - ูุตู ุงูุชุฐูุฑุฉ
โ process_id (UUID) - ูุนุฑู ุงูุนูููุฉ (ูุทููุจ)
โ recurrence_type (VARCHAR) - ููุน ุงูุชูุฑุงุฑ (ูุทููุจ)
โ start_date (TIMESTAMPTZ) - ุชุงุฑูุฎ ุงูุจุฏุงูุฉ (ูุทููุจ)
โ is_active (BOOLEAN) - ุชูุนูู ุงููุงุนุฏุฉ
```

### 3. ุฅุตูุงุญ Controller โ
- **ุงููุดููุฉ**: Controller ูุงู ูุณุชุฎุฏู ุญููู ูุฏููุฉ ุบูุฑ ููุฌูุฏุฉ
- **ุงูุญู**: ุชุญุฏูุซ ุฏุงูุฉ `create` ูุชุชูุงูู ูุน ุจููุฉ ุงูุฌุฏูู ุงูุฌุฏูุฏุฉ
- **ุงููุชูุฌุฉ**: ุฅูุดุงุก ุงูููุงุนุฏ ูุนูู ุจูุฌุงุญ

### 4. ุงุฎุชุจุงุฑ curl command โ

#### ุงูู curl ุงูุฃุตูู (ูุน ุฅุถุงูุฉ process_id):
```bash
curl -X 'POST' \
  'http://localhost:3003/api/recurring/rules' \
  -H 'accept: application/json' \
  -H 'Authorization: Bearer YOUR_TOKEN' \
  -H 'Content-Type: application/json' \
  -d '{
    "rule_name": "string",
    "rule_description": "string",
    "title": "string", 
    "description": "string",
    "process_id": "d6f7574c-d937-4e55-8cb1-0b19269e6061"
  }'
```

#### ุงููุชูุฌุฉ ุงููุชููุนุฉ:
```json
{
  "success": true,
  "message": "ุชู ุฅูุดุงุก ูุงุนุฏุฉ ุงูุชูุฑุงุฑ ุจูุฌุงุญ",
  "data": {
    "id": "uuid-generated",
    "name": "string",
    "rule_name": "string",
    "title": "string",
    "process_id": "d6f7574c-d937-4e55-8cb1-0b19269e6061",
    "recurrence_type": "daily",
    "is_active": true,
    "created_at": "2025-10-29T...",
    ...
  }
}
```

## ๐งช ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑ

### โ ุงูุนูููุงุช ุงูุชู ุชุนูู:
1. **ุฅูุดุงุก ูุงุนุฏุฉ ุฌุฏูุฏุฉ** - POST โ
2. **ุฌูุจ ุฌููุน ุงูููุงุนุฏ** - GET โ  
3. **ุฌูุจ ูุงุนุฏุฉ ูุงุญุฏุฉ** - GET /:id โ

### โ ุงูุนูููุงุช ุงูููุตูุญุฉ ุญุฏูุซุงู:
1. **ุชุญุฏูุซ ูุงุนุฏุฉ** - PUT /:id โ ูุนูู ุจุดูู ูุซุงูู

### โ๏ธ ุงูุนูููุงุช ุงูุชู ุชุญุชุงุฌ ุฅุตูุงุญ:
1. **ุญุฐู ูุงุนุฏุฉ** - DELETE /:id (ูุญุชุงุฌ ุชุญุฏูุซ Controller)

## ๐ ุงููููุงุช ุงููููุดุฃุฉ

### ูููุงุช SQL:
- `create-recurring-rules-table.sql` - ููู SQL ุงููุงูู
- `execute-recurring-rules-sql.js` - ุณูุฑูุจุช ุชูููุฐ SQL

### ูููุงุช ุงูุชูุซูู:
- `RECURRING_RULES_FINAL_REPORT.md` - ูุฐุง ุงูุชูุฑูุฑ

## ๐ง ุงูุญุงูุฉ ุงูุญุงููุฉ

### โ ูุง ูุนูู:
- ุงูุฌุฏูู ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุฅูุดุงุก ููุงุนุฏ ุฌุฏูุฏุฉ ูุนูู
- ุฌูุจ ุงูููุงุนุฏ ูุนูู
- ุชุญุฏูุซ ุงูููุงุนุฏ ูุนูู โ **ุฌุฏูุฏ**
- curl command ุงูุฃุตูู ูุนูู (ูุน ุฅุถุงูุฉ process_id)
- curl command ุงูุชุญุฏูุซ ูุนูู โ **ุฌุฏูุฏ**

### ๐๏ธ ูุง ูุญุชุงุฌ ุฅุตูุงุญ (ุงุฎุชูุงุฑู):
- ุฏุงูุฉ DELETE ูู Controller (ุชุณุชุฎุฏู ุญููู ูุฏููุฉ)
- ูููู ุฅุตูุงุญูุง ูุงุญูุงู ุญุณุจ ุงูุญุงุฌุฉ

## ๐ฏ ุงูุฎูุงุตุฉ

**ุชู ุชุญููู ุฌููุน ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ:**

โ **ุงูุฌุฏูู**: ุชู ุฅูุดุงุคู ุจูุฌุงุญ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช  
โ **ููู SQL**: ุชู ุฅูุดุงุคู ูุชูููุฐู ุจูุฌุงุญ  
โ **curl command**: ูุนูู ุจูุฌุงุญ ูุน ุฅุถุงูุฉ process_id  
โ **curl PUT command**: ูุนูู ุจูุฌุงุญ ููุชุญุฏูุซ โ **ุฌุฏูุฏ**

**ุงููุดุงูู ุงูุฃุตููุฉ ูุญูููุฉ:**
- ุฎุทุฃ `column "name" does not exist` โ ูุญููู
- ุฎุทุฃ `column "template_data" does not exist` โ ูุญููู
- ูููู ุงูุขู ุฅูุดุงุก ูุชุญุฏูุซ ููุงุนุฏ ุงูุชูุฑุงุฑ ุจูุฌุงุญ

**ููุงุณุชุฎุฏุงู ุงูููุฑู:**
```bash
# ุฅูุดุงุก ูุงุนุฏุฉ ุฌุฏูุฏุฉ
curl -X POST "http://localhost:3003/api/recurring/rules" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "rule_name": "ูุงุนุฏุฉ ุงุฎุชุจุงุฑ",
    "title": "ุชุฐูุฑุฉ ุงุฎุชุจุงุฑ", 
    "process_id": "d6f7574c-d937-4e55-8cb1-0b19269e6061"
  }'

# ุชุญุฏูุซ ูุงุนุฏุฉ ููุฌูุฏุฉ โ ุฌุฏูุฏ
curl -X PUT "http://localhost:3003/api/recurring/rules/{id}" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "ูุงุนุฏุฉ ูุงุจุด ูุซูุฉ"
  }'
```

---

**ุงูุญุงูุฉ**: โ **ููุชูู ูุฌุงูุฒ ููุงุณุชุฎุฏุงู**  
**ุงูุชุงุฑูุฎ**: 29 ุฃูุชูุจุฑ 2025
