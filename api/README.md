# Express Backend - Pipefy System

ูุธุงู ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ูุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช ุจุงุณุชุฎุฏุงู Express.js ู PostgreSQL.

## ุงููุชุทูุจุงุช

- Node.js (v14 ุฃู ุฃุญุฏุซ)
- PostgreSQL
- npm ุฃู yarn

## ุงูุชุซุจูุช

1. ุชุซุจูุช ุงูุญุฒู:

```bash
npm install
```

2. ุฅุนุฏุงุฏ ูุชุบูุฑุงุช ุงูุจูุฆุฉ:

```bash
cp .env.example .env
```

3. ุชุญุฏูุซ ููู `.env` ุจุฅุนุฏุงุฏุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจู.

4. ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุชุดุบูู ุงูู migrations:

```bash
npm run create-db
npm run migrate
```

5. ุฅูุดุงุก ูุณุชุฎุฏู ุงููุฏูุฑ:

```bash
node scripts/create-admin.js
```

## ุงูุชุดุบูู

### ูุถุน ุงูุชุทููุฑ

```bash
npm run dev
```

### ูุถุน ุงูุฅูุชุงุฌ

```bash
npm start
```

## ุงูุงุฎุชุจุงุฑ

ููุชุญูู ูู ุงุชุตุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

```bash
curl http://localhost:3000/test-db
```

ูููุตูู ุฅูู API:

```bash
curl http://localhost:3000/api
```

ูููุตูู ุฅูู ุชูุซูู Swagger:

```bash
http://localhost:3000/api-docs
```

## API Endpoints

### Authentication

- `POST /api/auth/login` - ุชุณุฌูู ุงูุฏุฎูู
- `POST /api/auth/logout` - ุชุณุฌูู ุงูุฎุฑูุฌ
- `POST /api/auth/refresh` - ุชุฌุฏูุฏ ุงูุชููู
- `GET /api/auth/verify` - ุงูุชุญูู ูู ุงูุชููู
- `POST /api/auth/change-password` - ุชุบููุฑ ูููุฉ ุงููุฑูุฑ

### Users

- `GET /api/users` - ุฌูุจ ุฌููุน ุงููุณุชุฎุฏููู
- `GET /api/users/me` - ุฌูุจ ุงูููู ุงูุดุฎุตู
- `GET /api/users/stats` - ุฅุญุตุงุฆูุงุช ุงููุณุชุฎุฏููู
- `GET /api/users/:id` - ุฌูุจ ูุณุชุฎุฏู ุจุงูู ID
- `POST /api/users` - ุฅูุดุงุก ูุณุชุฎุฏู ุฌุฏูุฏ
- `PUT /api/users/:id` - ุชุญุฏูุซ ูุณุชุฎุฏู
- `DELETE /api/users/:id` - ุญุฐู ูุณุชุฎุฏู
- `PATCH /api/users/:id/toggle-status` - ุชูุนูู/ุฅูุบุงุก ุชูุนูู ูุณุชุฎุฏู

### Roles

- `GET /api/roles` - ุฌูุจ ุฌููุน ุงูุฃุฏูุงุฑ
- `GET /api/roles/stats` - ุฅุญุตุงุฆูุงุช ุงูุฃุฏูุงุฑ
- `GET /api/roles/:id` - ุฌูุจ ุฏูุฑ ุจุงูู ID
- `POST /api/roles` - ุฅูุดุงุก ุฏูุฑ ุฌุฏูุฏ
- `PUT /api/roles/:id` - ุชุญุฏูุซ ุฏูุฑ
- `DELETE /api/roles/:id` - ุญุฐู ุฏูุฑ
- `GET /api/roles/:id/permissions` - ุฌูุจ ุตูุงุญูุงุช ุฏูุฑ
- `PUT /api/roles/:id/permissions` - ุชุญุฏูุซ ุตูุงุญูุงุช ุฏูุฑ
- `POST /api/roles/:id/permissions` - ุฅุถุงูุฉ ุตูุงุญูุฉ ูุฏูุฑ
- `DELETE /api/roles/:id/permissions/:permission_id` - ุฅุฒุงูุฉ ุตูุงุญูุฉ ูู ุฏูุฑ

### Permissions

- `GET /api/permissions` - ุฌูุจ ุฌููุน ุงูุตูุงุญูุงุช
- `GET /api/permissions/stats` - ุฅุญุตุงุฆูุงุช ุงูุตูุงุญูุงุช
- `GET /api/permissions/by-resource` - ุงูุตูุงุญูุงุช ุญุณุจ ุงูููุฑุฏ
- `GET /api/permissions/resources` - ุฌูุจ ุฌููุน ุงูููุงุฑุฏ
- `GET /api/permissions/:id` - ุฌูุจ ุตูุงุญูุฉ ุจุงูู ID
- `POST /api/permissions` - ุฅูุดุงุก ุตูุงุญูุฉ ุฌุฏูุฏุฉ
- `PUT /api/permissions/:id` - ุชุญุฏูุซ ุตูุงุญูุฉ
- `DELETE /api/permissions/:id` - ุญุฐู ุตูุงุญูุฉ

## ุงูุจููุฉ

```
express-backend/
โโโ config/          # ุฅุนุฏุงุฏุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
โโโ controllers/     # Controllers ููู API
โโโ middleware/      # Middleware ูููุตุงุฏูุฉ ูุงูุชุญูู
โโโ migrations/      # ูููุงุช ุงูุชุฑุญูู
โโโ models/          # ููุงุฐุฌ ูุงุนุฏุฉ ุงูุจูุงูุงุช
โโโ routes/          # ุชุนุฑูู ุงููุณุงุฑุงุช
โโโ scripts/         # ุณูุฑูุจุชุงุช ูุณุงุนุฏุฉ
โโโ services/        # ููุทู ุงูุฃุนูุงู
โโโ .env            # ูุชุบูุฑุงุช ุงูุจูุฆุฉ
โโโ server.js       # ุงูููู ุงูุฑุฆูุณู
โโโ README.md       # ูุฐุง ุงูููู
```

## ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ

- `DB_HOST`: ุนููุงู ุฎุงุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- `DB_PORT`: ูููุฐ ูุงุนุฏุฉ ุงูุจูุงูุงุช
- `DB_DATABASE`: ุงุณู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- `DB_USERNAME`: ุงุณู ุงููุณุชุฎุฏู
- `DB_PASSWORD`: ูููุฉ ุงููุฑูุฑ
- `PORT`: ูููุฐ ุงูุฎุงุฏู (ุงูุชุฑุงุถู: 3000)
- `JWT_SECRET`: ููุชุงุญ ุชุดููุฑ JWT
- `JWT_EXPIRES_IN`: ูุฏุฉ ุงูุชูุงุก ุตูุงุญูุฉ ุงูุชููู

## ุจูุงูุงุช ุงูุฏุฎูู ุงูุงูุชุฑุงุถูุฉ

ุจุนุฏ ุชุดุบูู `node scripts/create-admin.js`:

- **ุงูุจุฑูุฏ ุงูุฅููุชุฑููู**: admin@pipefy.com
- **ูููุฉ ุงููุฑูุฑ**: admin123

## ุงูููุฒุงุช

- โ ูุธุงู ูุตุงุฏูุฉ JWT
- โ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ูุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช
- โ ูุธุงู ุตูุงุญูุงุช ูุชูุฏู (RBAC)
- โ ุญูุงูุฉ ูููุงุช ุงููุฑูุฑ ุจู bcrypt
- โ ููู ุงูุญุณุงุจ ุจุนุฏ ูุญุงููุงุช ูุงุดูุฉ
- โ Soft delete ูููุณุชุฎุฏููู
- โ ุชุชุจุน ุขุฎุฑ ุฏุฎูู ููุญุงููุงุช ุงูุฏุฎูู
- โ ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช ุงูุฅุถุงููุฉ ูููุณุชุฎุฏููู
- โ ูุณุฎ ุงูุตูุงุญูุงุช ุจูู ุงูุฃุฏูุงุฑ
- โ ุฅุญุตุงุฆูุงุช ุดุงููุฉ ูููุธุงู
- โ **ุชูุซูู Swagger ุดุงูู** ูุฌููุน ุงูู APIs

## ุชูุซูู Swagger

ููููู ุงููุตูู ุฅูู ุชูุซูู Swagger ุงูุชูุงุนูู ุนูู:

**๐ [http://localhost:3000/api-docs](http://localhost:3000/api-docs)**

ุงูููุฒุงุช ุงููุชููุฑุฉ ูู Swagger:
- ุชูุซูู ุดุงูู ูุฌููุน ุงูู endpoints
- ุฅููุงููุฉ ุงุฎุชุจุงุฑ ุงูู APIs ูุจุงุดุฑุฉ
- ุฃูุซูุฉ ุนูู ุงูุทูุจุงุช ูุงูุงุณุชุฌุงุจุงุช
- ุชูุงุตูู ุงููุนุงููุงุช ูุงูุงุณุชุฌุงุจุงุช
- ุฏุนู ุงููุตุงุฏูุฉ JWT
- ูุงุฌูุฉ ุชูุงุนููุฉ ุณููุฉ ุงูุงุณุชุฎุฏุงู
