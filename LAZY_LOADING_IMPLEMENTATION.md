# ูุธุงู Lazy Loading ููุชุฐุงูุฑ ูู ุงููุงูุจุงู

## ุงููุตู
ุชู ุชุทุจูู ูุธุงู **Lazy Loading ุจุณูุท** ูุชุญููู ุงูุชุฐุงูุฑ ูู ููุญุฉ ุงููุงูุจุงู ุจุดูู ุชุฏุฑูุฌู.

## ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1. ุงูุชุญููู ุงูุฃููู
- ุนูุฏ ูุชุญ ุตูุญุฉ ุงููุงูุจุงูุ ูุชู ุฌูุจ **25 ุชุฐูุฑุฉ** ููู ูุฑุญูุฉ
- ูุชู ุนุฑุถ ุงูุชุฐุงูุฑ ููุฑุงู ูู ุงูุฃุนูุฏุฉ ุงูููุงุณุจุฉ

### 2. ุงูุชุญููู ุงูุชุฏุฑูุฌู (Lazy Loading)
- ูู ููุงูุฉ ูู ุนููุฏุ ูุธูุฑ ุฒุฑ **"ุชุญููู ุงููุฒูุฏ"**
- ุนูุฏ ุงูุถุบุท ุนูู ุงูุฒุฑุ ูุชู ุฌูุจ **25 ุชุฐูุฑุฉ ุฅุถุงููุฉ** ูุชูู ุงููุฑุญูุฉ ููุท
- ูุฎุชูู ุงูุฒุฑ ุนูุฏูุง ูุง ููุฌุฏ ุงููุฒูุฏ ูู ุงูุชุฐุงูุฑ

### 3. ูุคุดุฑุงุช ุงูุชุญููู
- ุฃุซูุงุก ุงูุชุญููู ุงูุฃููู: ุฑุณุงูุฉ "ุฌุงุฑู ุชุญููู ุงูุชุฐุงูุฑ..."
- ุฃุซูุงุก ุชุญููู ุงููุฒูุฏ: ุฃููููุฉ ุฏูุงุฑุฉ ูุน ูุต "ุฌุงุฑู ุงูุชุญููู..."
- ุจุนุฏ ุงูุชุญููู: ุฑุณุงูุฉ ูุฌุงุญ ุจุนุฏุฏ ุงูุชุฐุงูุฑ ุงููุญููุฉ

## ุงูุชุนุฏููุงุช ุงููุทุจูุฉ

### 1. KanbanBoard.tsx
**State ุฌุฏูุฏ:**
```typescript
const [stageOffsets, setStageOffsets] = useState<Record<string, number>>({});
const [stageHasMore, setStageHasMore] = useState<Record<string, boolean>>({});
const [loadingMoreStages, setLoadingMoreStages] = useState<Record<string, boolean>>({});
const TICKETS_PER_PAGE = 25;
```

**ุฏุงูุฉ loadTickets():**
- ุชู ุชุบููุฑ `limit` ูู 100 ุฅูู `TICKETS_PER_PAGE` (25)
- ุชููุฆุฉ ุญุงูุฉ ุงูู Lazy Loading ููู ูุฑุญูุฉ
- ุชุชุจุน ุงูู offset ูุงูู hasMore ููู ูุฑุญูุฉ

**ุฏุงูุฉ loadMoreTickets():**
```typescript
const loadMoreTickets = async (stageId: string) => {
  // ุฌูุจ 25 ุชุฐูุฑุฉ ุฅุถุงููุฉ ูููุฑุญูุฉ ุงููุญุฏุฏุฉ
  // ุชุญุฏูุซ ุงูู offset
  // ุชุญุฏูุซ ุญุงูุฉ "ูู ููุฌุฏ ุงููุฒูุฏ"
}
```

**ุชูุฑูุฑ Props ููุฃุนูุฏุฉ:**
```typescript
<KanbanColumn
  hasMore={stageHasMore[stage.id] || false}
  loadingMore={loadingMoreStages[stage.id] || false}
  onLoadMore={() => loadMoreTickets(stage.id)}
/>
```

### 2. KanbanColumn.tsx
**Props ุฌุฏูุฏุฉ:**
```typescript
interface KanbanColumnProps {
  // ... props ููุฌูุฏุฉ
  hasMore: boolean;
  loadingMore: boolean;
  onLoadMore: () => void;
}
```

**ุฒุฑ "ุชุญููู ุงููุฒูุฏ":**
```tsx
{hasMore && tickets.length > 0 && !isOver && (
  <button onClick={onLoadMore} disabled={loadingMore}>
    {loadingMore ? (
      <>
        <Loader2 className="animate-spin" />
        <span>ุฌุงุฑู ุงูุชุญููู...</span>
      </>
    ) : (
      <>
        <ChevronDown />
        <span>ุชุญููู ุงููุฒูุฏ</span>
      </>
    )}
  </button>
)}
```

### 3. ticketService.ts
**ุฏุนู offset ูู getTicketsByStages():**
```typescript
async getTicketsByStages(params: TicketsByStagesParams) {
  const queryParams = {
    process_id: params.process_id,
    stage_ids: JSON.stringify(params.stage_ids),
    limit: params.limit || 50,
    offset: params.offset || 0  // โ ุฏุนู ุงูู offset
  };
}
```

## API Endpoint ุงููุณุชุฎุฏู

```
GET /api/tickets/by-stages
```

**Parameters:**
- `process_id` (required): ูุนุฑู ุงูุนูููุฉ
- `stage_ids` (required): ูุตูููุฉ ูุนุฑูุงุช ุงููุฑุงุญู (JSON)
- `limit` (optional): ุนุฏุฏ ุงูุชุฐุงูุฑ ููู ูุฑุญูุฉ (ุงูุชุฑุงุถู: 25)
- `offset` (optional): ููุทุฉ ุงูุจุฏุงูุฉ ููุชุญููู (ุงูุชุฑุงุถู: 0)

**ูุซุงู:**
```
GET /api/tickets/by-stages?process_id=xxx&stage_ids=["stage1","stage2"]&limit=25&offset=0
GET /api/tickets/by-stages?process_id=xxx&stage_ids=["stage1"]&limit=25&offset=25
```

## ุณููุงุฑูููุงุช ุงูุงุณุชุฎุฏุงู

### ุงูุณููุงุฑูู 1: ุงูุชุญููู ุงูุฃููู
1. ุงููุณุชุฎุฏู ููุชุญ ุตูุญุฉ ุงููุงูุจุงู
2. ูุชู ุฌูุจ 25 ุชุฐูุฑุฉ ููู ูุฑุญูุฉ
3. ุชุธูุฑ ุงูุชุฐุงูุฑ ูู ุงูุฃุนูุฏุฉ
4. ุฅุฐุง ูุงู ููุงู 25 ุชุฐูุฑุฉ ุฃู ุฃูุซุฑุ ูุธูุฑ ุฒุฑ "ุชุญููู ุงููุฒูุฏ"

### ุงูุณููุงุฑูู 2: ุชุญููู ุงููุฒูุฏ
1. ุงููุณุชุฎุฏู ูุถุบุท ุนูู "ุชุญููู ุงููุฒูุฏ" ูู ุนููุฏ ูุนูู
2. ูุชู ุฌูุจ 25 ุชุฐูุฑุฉ ุฅุถุงููุฉ ูุชูู ุงููุฑุญูุฉ ููุท
3. ุชูุถุงู ุงูุชุฐุงูุฑ ุงูุฌุฏูุฏุฉ ูู ููุงูุฉ ุงููุงุฆูุฉ
4. ุฅุฐุง ูุงู ุนุฏุฏ ุงูุชุฐุงูุฑ ุงููุญููุฉ ุฃูู ูู 25ุ ูุฎุชูู ุงูุฒุฑ

### ุงูุณููุงุฑูู 3: ูุง ููุฌุฏ ุงููุฒูุฏ
1. ุนูุฏูุง ูุชู ุชุญููู ุฌููุน ุงูุชุฐุงูุฑ
2. ูุฎุชูู ุฒุฑ "ุชุญููู ุงููุฒูุฏ" ุชููุงุฆูุงู
3. ูููู ูููุณุชุฎุฏู ุงูุชูุฑูุฑ ุนุจุฑ ุฌููุน ุงูุชุฐุงูุฑ ุงููุญููุฉ

## ุงูุฃุฏุงุก ูุงูุชุญุณููุงุช

### ุงููุฒุงูุง:
- โ **ุชุญููู ุฃุณุฑุน**: 25 ุชุฐูุฑุฉ ุจุฏูุงู ูู ุฌููุน ุงูุชุฐุงูุฑ
- โ **ุงุณุชููุงู ุฃูู ููุฐุงูุฑุฉ**: ุชุญููู ุชุฏุฑูุฌู ุญุณุจ ุงูุญุงุฌุฉ
- โ **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุถู**: ุงุณุชุฌุงุจุฉ ููุฑูุฉ
- โ **ุจุณูุท ููุงุถุญ**: ูุง ุชุนููุฏุงุช ูู ุงูุชุทุจูู

### ุงูุชุญุณููุงุช ุงููุณุชูุจููุฉ (ุงุฎุชูุงุฑูุฉ):
- Infinite Scroll: ุชุญููู ุชููุงุฆู ุนูุฏ ุงููุตูู ูููุงูุฉ ุงูุนููุฏ
- Virtualization: ุนุฑุถ ุงูุชุฐุงูุฑ ุงููุฑุฆูุฉ ููุท
- Caching: ุญูุธ ุงูุชุฐุงูุฑ ุงููุญููุฉ ูู ุงูุฐุงูุฑุฉ

## ุงููููุงุช ุงููุชุฃุซุฑุฉ

1. **src/components/kanban/KanbanBoard.tsx**
   - ุฅุถุงูุฉ state ููู Lazy Loading
   - ุฏุงูุฉ `loadMoreTickets()`
   - ุชูุฑูุฑ props ููุฃุนูุฏุฉ

2. **src/components/kanban/KanbanColumn.tsx**
   - ุฅุถุงูุฉ props ุฌุฏูุฏุฉ
   - ุฒุฑ "ุชุญููู ุงููุฒูุฏ"
   - ูุคุดุฑุงุช ุงูุชุญููู

3. **src/services/ticketService.ts**
   - ุฏุนู `offset` ูู `getTicketsByStages()`

## ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ูุฏูู:
1. ุงูุชุญ ุตูุญุฉ ุงููุงูุจุงู
2. ุชุญูู ูู ุธููุฑ 25 ุชุฐูุฑุฉ ููู ูุฑุญูุฉ
3. ุงุถุบุท ุนูู "ุชุญููู ุงููุฒูุฏ" ูู ุฃู ุนููุฏ
4. ุชุญูู ูู ุชุญููู 25 ุชุฐูุฑุฉ ุฅุถุงููุฉ
5. ูุฑุฑ ุญุชู ุชุฎุชูู ุงูุฒุฑ

### Console Logs:
```javascript
console.log(`ุฌูุจ ุงููุฒูุฏ ูู ุงูุชุฐุงูุฑ ูููุฑุญูุฉ: ${stageId}`);
console.log(`ุชู ุชุญููู ${newTickets.length} ุชุฐูุฑุฉ ุฅุถุงููุฉ`);
```

## ุงูุฎูุงุตุฉ

ุชู ุชุทุจูู ูุธุงู Lazy Loading ุจุณูุท ููุนุงู:
- โ 25 ุชุฐูุฑุฉ ูู ุงูุชุญููู ุงูุฃููู
- โ 25 ุชุฐูุฑุฉ ุฅุถุงููุฉ ุนูุฏ ุงูุทูุจ
- โ ุฒุฑ "ุชุญููู ุงููุฒูุฏ" ูุงุถุญ ูุจุณูุท
- โ ูุคุดุฑุงุช ุชุญููู ุฌูููุฉ
- โ ุจุฏูู ุชุนููุฏุงุช

**ุงููุชูุฌุฉ**: ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณุฑูุนุฉ ูุณูุณุฉ ูุน ุฃุฏุงุก ูุญุณูู! ๐
