# ๐ ุฏููู ุงุฎุชุจุงุฑ WebSocket

## โ ุชู ุงูุชูููุฐ ุจูุฌุงุญ

ุชู ุชูููุฐ ูุธุงู WebSocket ุงููุงูู ููุชุญุฏูุซ ุงูููุฑู ููุชุฐุงูุฑ ุจูู ุงููุณุชุฎุฏููู!

## ๐ ูุง ุชู ุชูููุฐู

### Backend (API)
1. โ ุชุซุจูุช `socket.io` ูู `api/`
2. โ ุฅูุดุงุก `api/services/websocketService.js`
3. โ ุชุนุฏูู `api/server.js` ูุฅุถุงูุฉ Socket.IO
4. โ ุฅุถุงูุฉ WebSocket events ูู `TicketController.js`:
   - `emitTicketCreated` ุนูุฏ ุฅูุดุงุก ุชุฐูุฑุฉ
   - `emitTicketUpdated` ุนูุฏ ุชุญุฏูุซ ุชุฐูุฑุฉ
   - `emitTicketDeleted` ุนูุฏ ุญุฐู ุชุฐูุฑุฉ
5. โ ุฅุถุงูุฉ WebSocket event ูู `routes/tickets.js`:
   - `emitTicketMoved` ุนูุฏ ููู ุชุฐูุฑุฉ

### Frontend
1. โ ุชุซุจูุช `socket.io-client`
2. โ ุฅูุดุงุก `src/services/socketService.ts`
3. โ ุฑุจุท WebSocket ูุน `KanbanBoard.tsx`:
   - ุงูุงุชุตุงู ุงูุชููุงุฆู ุนูุฏ ูุชุญ ุงูุตูุญุฉ
   - ุงูุงูุถูุงู ูุบุฑูุฉ ุงูุนูููุฉ
   - ูุนุงูุฌุฉ ุงูุฃุญุฏุงุซ ุงููุงุฑุฏุฉ
   - ุชุญุฏูุซ ุงูุญุงูุฉ ุงููุญููุฉ ุชููุงุฆูุงู

## ๐งช ููููุฉ ุงูุงุฎุชุจุงุฑ

### ุงูุทุฑููุฉ 1: ุงุฎุชุจุงุฑ ูุจุงุดุฑ ูู ุงููุธุงู

1. **ุงูุชุญ ูุชุตูุญูู** (ุฃู ูุงูุฐุชูู ุฎููุชูู)
2. **ุณุฌู ุฏุฎูู ุจูุณุชุฎุฏููู ูุฎุชูููู** ูู ูู ูุชุตูุญ
3. **ุงูุชุญ ููุณ ุงูุนูููุฉ (Process)** ูู ููุง ุงููุชุตูุญูู
4. **ูู ุงููุชุตูุญ ุงูุฃูู:**
   - ุฃูุดุฆ ุชุฐูุฑุฉ ุฌุฏูุฏุฉ
   - ุงููู ุชุฐูุฑุฉ
   - ุญุฏุซ ุชุฐูุฑุฉ
   - ุงุญุฐู ุชุฐูุฑุฉ

5. **ูู ุงููุชุตูุญ ุงูุซุงูู:**
   - ูุฌุจ ุฃู ุชุฑู ุงูุชุญุฏูุซุงุช **ููุฑุงู ุจุฏูู refresh**!

### ุงูุทุฑููุฉ 2: ุงุณุชุฎุฏุงู ููู ุงูุงุฎุชุจุงุฑ

1. **ุงูุชุญ `test-websocket.html`** ูู ุงููุชุตูุญ
2. **ุงุญุตู ุนูู Token:**
   - ุณุฌู ุฏุฎููู ูู ุงููุธุงู
   - ุงูุชุญ Console (F12)
   - ุงูุชุจ: `localStorage.getItem("token")`
   - ุงูุณุฎ ุงูู Token

3. **ูู ููู ุงูุงุฎุชุจุงุฑ:**
   - ุฃูุตู ุงูู Token
   - ุงุถุบุท "ุงุชุตุงู"
   - ุฃุฏุฎู ูุนุฑู ุงูุนูููุฉ (Process ID)
   - ุงุถุบุท "ุงูุงูุถูุงู ููุนูููุฉ"

4. **ุงูุขู ูู ุจุฅูุดุงุก/ุชุญุฏูุซ ุชุฐูุฑุฉ ูู ุงููุชุตูุญ ุงูุขุฎุฑ**
   - ุณุชุธูุฑ ุงูุฃุญุฏุงุซ ูู ููู ุงูุงุฎุชุจุงุฑ ููุฑุงู!

## ๐ ุงูุชุญูู ูู ุนูู WebSocket

### ูู Console ุงููุชุตูุญ

ุงูุชุญ Console (F12) ูุงุจุญุซ ุนู:

```
โ WebSocket connected
โ Joined process: [process-id]
๐จ Ticket created event received: {ticket data}
๐จ Ticket updated event received: {ticket data}
๐จ Ticket moved event received: {ticket data}
๐จ Ticket deleted event received: {ticket data}
```

### ูู Backend Console

ุงุจุญุซ ุนู:

```
โ WebSocket service initialized
๐ WebSocket server ready
โ User [userId] ([userName]) connected to WebSocket
โ User [userId] joined process [processId]
๐ค Emitting ticket-created for ticket [ticketId] to process-[processId]
โ ticket-created event sent successfully
```

## ๐ฏ ุงูุณููุงุฑูู ุงููุชููุน

### ูุจู WebSocket โ
1. ุงููุณุชุฎุฏู 1 ููุดุฆ ุชุฐูุฑุฉ
2. ุงููุณุชุฎุฏู 2 **ูุง ูุฑู** ุงูุชุฐูุฑุฉ
3. ุงููุณุชุฎุฏู 2 ูุฌุจ ุฃู ูุนูู **Refresh (F5)**
4. ุงูุขู ูุฑู ุงููุณุชุฎุฏู 2 ุงูุชุฐูุฑุฉ

### ุจุนุฏ WebSocket โ
1. ุงููุณุชุฎุฏู 1 ููุดุฆ ุชุฐูุฑุฉ
2. ุงููุณุชุฎุฏู 2 ูุฑู ุงูุชุฐูุฑุฉ **ููุฑุงู**!
3. ูุง ุญุงุฌุฉ ูู Refresh
4. ุชุธูุฑ ุฅุดุนุงุฑ Toast: "ุชุฐูุฑุฉ ุฌุฏูุฏุฉ: [ุนููุงู ุงูุชุฐูุฑุฉ]"

## ๐ ุงูุฃุญุฏุงุซ ุงููุฏุนููุฉ

| ุงูุญุฏุซ | ูุชู ูุญุฏุซ | ูุง ูุญุฏุซ |
|-------|----------|---------|
| `ticket-created` | ุฅูุดุงุก ุชุฐูุฑุฉ ุฌุฏูุฏุฉ | ุชุธูุฑ ุงูุชุฐูุฑุฉ ูู ุงููุฑุญูุฉ ุงูููุงุณุจุฉ |
| `ticket-updated` | ุชุญุฏูุซ ุจูุงูุงุช ุชุฐูุฑุฉ | ุชุชุญุฏุซ ุจูุงูุงุช ุงูุชุฐูุฑุฉ ูู ููุงููุง |
| `ticket-moved` | ููู ุชุฐูุฑุฉ ุจูู ุงููุฑุงุญู | ุชุฎุชูู ูู ุงููุฑุญูุฉ ุงููุฏููุฉ ูุชุธูุฑ ูู ุงูุฌุฏูุฏุฉ |
| `ticket-deleted` | ุญุฐู ุชุฐูุฑุฉ | ุชุฎุชูู ุงูุชุฐูุฑุฉ ูู ุงููุงุฌูุฉ |

## ๐๏ธ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฅุฐุง ูู ูุนูู WebSocket

1. **ุชุญูู ูู Backend:**
   ```bash
   # ูุฌุจ ุฃู ูุนูู ุนูู ุงููููุฐ 3004
   curl http://192.168.56.1:3004/api/health
   ```

2. **ุชุญูู ูู Console:**
   - ุงูุชุญ F12
   - ุงุจุญุซ ุนู ุฃุฎุทุงุก WebSocket
   - ุชุฃูุฏ ูู ุฑุคูุฉ "WebSocket connected"

3. **ุชุญูู ูู Token:**
   ```javascript
   // ูู Console
   localStorage.getItem('token')
   // ูุฌุจ ุฃู ูุนูุฏ token ุตุญูุญ
   ```

4. **ุชุญูู ูู Process ID:**
   - ุชุฃูุฏ ูู ุฃู Process ID ุตุญูุญ
   - ุชุญูู ูู ุฃู ุงููุณุชุฎุฏู ูุฑุชุจุท ุจุงูุนูููุฉ

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู! ุงูุขู:

1. โ ุณุฌู ุฏุฎูู ุจูุณุชุฎุฏููู ูุฎุชูููู
2. โ ุงูุชุญ ููุณ ุงูุนูููุฉ
3. โ ุฌุฑุจ ุฅูุดุงุก/ุชุญุฏูุซ/ููู/ุญุฐู ุงูุชุฐุงูุฑ
4. โ ุดุงูุฏ ุงูุชุญุฏูุซุงุช ุงูููุฑูุฉ!

## ๐ ููุงุญุธุงุช ูููุฉ

- โ WebSocket ูุนูู ููุท ูุน ุงููุณุชุฎุฏููู ุงููุตุฑุญ ููู
- โ ูุฌุจ ุฃู ูููู ุงููุณุชุฎุฏู ูุฑุชุจุทุงู ุจุงูุนูููุฉ (user_processes)
- โ ูุฌุจ ุฃู ูููู ูุฏู ุงููุณุชุฎุฏู ุตูุงุญูุฉ `tickets.read`
- โ ุงูุชุญุฏูุซุงุช ุชุตู ููุท ูููุณุชุฎุฏููู ุงูููุฌูุฏูู ูู ููุณ ุงูุนูููุฉ

## ๐ ุงููุฌุงุญ!

ุฅุฐุง ุฑุฃูุช ุงูุชุญุฏูุซุงุช ุงูููุฑูุฉุ ููุฐุง ูุนูู ุฃู WebSocket ูุนูู ุจูุฌุงุญ! ๐

---

**ููุงุญุธุฉ:** Backend ูุฌุจ ุฃู ูุนูู ุนูู `http://192.168.56.1:3004` ู Frontend ุนูู `http://192.168.56.1:8080`

