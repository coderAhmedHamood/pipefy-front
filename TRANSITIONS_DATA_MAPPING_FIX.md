# ๐ง ุฅุตูุงุญ ุชุทุงุจู ุจูุงูุงุช ุงูุงูุชูุงูุงุช ุจูู API ูุงููุงุฌูุฉ

## ๐ฏ **ุงููุดููุฉ ุงููุญุฏุฏุฉ:**

### **ุนุฏู ุชุทุงุจู ูููู ุงูุจูุงูุงุช:**
- **API Response**: ูุฑุฌุน `transitions: []` (ูุตูููุฉ ูุงุฆูุงุช ููุตูุฉ)
- **Frontend Expects**: ูุชููุน `allowed_transitions: []` (ูุตูููุฉ ูุนุฑูุงุช ุจุณูุทุฉ)

### **ูุซุงู ุนูู ุงูุจูุงูุงุช ูู API:**
```json
{
  "id": "19f66b1c-b05c-43ae-9604-3ccb0b137474",
  "name": "ููุชููุฉ",
  "transitions": [
    {
      "id": "4cc34611-6733-4ae4-b08b-c4c13f7c009d",
      "from_stage_id": "19f66b1c-b05c-43ae-9604-3ccb0b137474",
      "to_stage_id": "cdfdd987-7e56-491a-9e4f-79aae28e15a9",
      "to_stage_name": "ููุณุชูููุด",
      "to_stage_color": "bg-gray-500"
    },
    {
      "id": "40a8e169-e70d-492e-bb64-75be2e272fb4", 
      "from_stage_id": "19f66b1c-b05c-43ae-9604-3ccb0b137474",
      "to_stage_id": "9b6bdb1f-3c31-46d1-aaf8-85bc07cd1408",
      "to_stage_name": "ุชุญุช ุงููุฑุงุฌุนุฉ",
      "to_stage_color": "bg-purple-500"
    }
  ]
}
```

### **ูุง ุชุชููุนู ุงููุงุฌูุฉ:**
```javascript
{
  id: "19f66b1c-b05c-43ae-9604-3ccb0b137474",
  name: "ููุชููุฉ",
  allowed_transitions: [
    "cdfdd987-7e56-491a-9e4f-79aae28e15a9",
    "9b6bdb1f-3c31-46d1-aaf8-85bc07cd1408"
  ]
}
```

## โ **ุงูุญููู ุงููุทุจูุฉ:**

### **1. ุฅุตูุงุญ WorkflowContext.tsx**

#### **ุงููุดููุฉ ุงูุฃุตููุฉ:**
```javascript
// โ ูุญุงูู ุงููุตูู ูุญูู ุบูุฑ ููุฌูุฏ
allowed_transitions: stage.allowed_transitions || [],
```

#### **ุงูุญู ุงููุทุจู:**
```javascript
// โ ูุชุญูู ูู ูุฌูุฏ transitions ููุญูููุง ููุตูููุฉ ูุนุฑูุงุช
allowed_transitions: stage.allowed_transitions || (stage.transitions ? stage.transitions.map((t: any) => t.to_stage_id) : []),
```

### **2. ุฅุตูุงุญ ProcessManager.tsx**

#### **ุงููุดููุฉ ูู ููุก ุงููููุฐุฌ:**
```javascript
// โ ูุญุงูู ุงููุตูู ูุญูู ุบูุฑ ููุฌูุฏ ุนูุฏ ุงูุชุญุฑูุฑ
allowed_transitions: stage.allowed_transitions || [],
```

#### **ุงูุญู ุงููุทุจู:**
```javascript
// โ ูุชุญูู ูู ูุฌูุฏ transitions ููุญูููุง ููุตูููุฉ ูุนุฑูุงุช
allowed_transitions: stage.allowed_transitions || ((stage as any).transitions ? (stage as any).transitions.map((t: any) => t.to_stage_id) : []),
```

## ๐ **ุชุฏูู ุงูุจูุงูุงุช ุงูููุตุญุญ:**

### **1. ุนูุฏ ุฌูุจ ุงูุจูุงูุงุช ูู API:**
```
API Response (transitions) โ WorkflowContext โ ุชุญููู ูู allowed_transitions โ State
```

### **2. ุนูุฏ ูุชุญ ูููุฐุฌ ุงูุชุญุฑูุฑ:**
```
Stage Data โ ProcessManager โ ุงุณุชุฎุฑุงุฌ allowed_transitions ูู transitions โ Form State
```

### **3. ุนูุฏ ุญูุธ ุงูุชุบููุฑุงุช:**
```
Form State (allowed_transitions) โ API Request โ Database Update โ Response โ State Update
```

## ๐งช **ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญุงุช:**

### **1. ุดุบู ุงูุฎุงุฏู:**
```bash
cd api && node server.js
```

### **2. ุงูุชุญ ุงูุชุทุจูู:**
```
http://localhost:5174/processes
```

### **3. ุงุฎุชุจุฑ ุนุฑุถ ุงูุงูุชูุงูุงุช ุงูุญุงููุฉ:**
1. ุงุฎุชุฑ ุนูููุฉ ุชุญุชูู ุนูู ูุฑุงุญู ุจุงูุชูุงูุงุช
2. ูุงุญุธ ุนุฏุฏ ุงูุงูุชูุงูุงุช ุงููุนุฑูุถ ูู ุจุทุงูุฉ ูู ูุฑุญูุฉ
3. **ุชุญูู**: ุงูุนุฏุฏ ูุฌุจ ุฃู ูุทุงุจู ุนุฏุฏ ุงูุงูุชูุงูุงุช ุงููุนููุฉ

### **4. ุงุฎุชุจุฑ ุชุญุฑูุฑ ุงูุงูุชูุงูุงุช:**
1. ุงุถุบุท ุชุญุฑูุฑ ุนูู ูุฑุญูุฉ ููุง ุงูุชูุงูุงุช ููุฌูุฏุฉ
2. **ุชุญูู**: ุงูุงูุชูุงูุงุช ุงูุญุงููุฉ ููุญุฏุฏุฉ ูู checkboxes
3. ุบูุฑ ุงูุงูุชูุงูุงุช (ุฃุถู/ุงุญุฐู)
4. ุงุญูุธ ุงูุชุบููุฑุงุช
5. **ุชุญูู**: ุงูุนุฏุฏ ุงูุฌุฏูุฏ ูุธูุฑ ูู ุจุทุงูุฉ ุงููุฑุญูุฉ ููุฑุงู

### **5. ุชุญูู ูู Console:**
```
๐ ุจูุงูุงุช ุงููุฑุญูุฉ ุงููุญุฏุซุฉ: {...}
๐ allowed_transitions ูู ุงูุงุณุชุฌุงุจุฉ: ["stage-id-1", "stage-id-2"]
๐ ุชูุงุตูู ุงูุญููู ุงูุญุฑุฌุฉ:
  - allowed_transitions: ["stage-id-1", "stage-id-2"] (ุนุฏุฏ: 2)
```

## ๐ฏ **ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**

### **โ ุนุฑุถ ุงูุงูุชูุงูุงุช ุงูุญุงููุฉ:**
- ุนูุฏ ูุชุญ ูููุฐุฌ ุงูุชุญุฑูุฑุ ุงูุงูุชูุงูุงุช ุงูุญุงููุฉ ููุญุฏุฏุฉ โ
- ุนุฏุฏ ุงูุงูุชูุงูุงุช ูู ุจุทุงูุฉ ุงููุฑุญูุฉ ุตุญูุญ โ
- ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู Console โ

### **โ ุชุญุฑูุฑ ุงูุงูุชูุงูุงุช:**
- ุฅุถุงูุฉ ุงูุชูุงูุงุช ุฌุฏูุฏุฉ ุชุนูู โ
- ุญุฐู ุงูุชูุงูุงุช ููุฌูุฏุฉ ูุนูู โ
- ุงูุชุญุฏูุซุงุช ุชุธูุฑ ููุฑุงู ูู ุงููุงุฌูุฉ โ
- ุงูุจูุงูุงุช ุชูุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช โ

### **โ ูุฒุงููุฉ ุงูุจูุงูุงุช:**
- ุงูุจูุงูุงุช ูู API ุชูุญูู ุจุดูู ุตุญูุญ โ
- ุงููููุฐุฌ ููููุฃ ุจุงูุจูุงูุงุช ุงูุตุญูุญุฉ โ
- ุงูุชุญุฏูุซุงุช ุชูุฑุณู ูุชูุญูุธ ุจุดูู ุตุญูุญ โ

## ๐ **ุงููููุงุช ุงูููุญุฏููุซุฉ:**

### **1. `src/contexts/WorkflowContext.tsx`**
- **ุงูุณุทุฑ 241**: ุฅุถุงูุฉ ุชุญููู `transitions` ุฅูู `allowed_transitions`

### **2. `src/components/processes/ProcessManager.tsx`**
- **ุงูุณุทุฑ 1058**: ุฅุถุงูุฉ ุชุญููู `transitions` ุฅูู `allowed_transitions` ุนูุฏ ููุก ุงููููุฐุฌ

## ๐ **ุงูุชูุงุตูู ุงูุชูููุฉ:**

### **ุชุญููู ุงูุจูุงูุงุช:**
```javascript
// ูู ูุฐุง ุงูุดูู (API Response)
transitions: [
  { to_stage_id: "stage-1", to_stage_name: "ูุฑุญูุฉ 1" },
  { to_stage_id: "stage-2", to_stage_name: "ูุฑุญูุฉ 2" }
]

// ุฅูู ูุฐุง ุงูุดูู (Frontend State)
allowed_transitions: ["stage-1", "stage-2"]
```

### **Type Safety:**
- ุงุณุชุฎุฏุงู `(stage as any)` ููุชุนุงูู ูุน TypeScript
- ุงูุชุญูู ูู ูุฌูุฏ `transitions` ูุจู ุงูุชุญููู
- ุงุณุชุฎุฏุงู fallback ุฅูู ูุตูููุฉ ูุงุฑุบุฉ

---

**๐ ุงูุขู ุฌููุน ุงูุงูุชูุงูุงุช ุชูุนุฑุถ ูุชูุญุฑุฑ ุจุดูู ุตุญูุญ ูุน ูุฒุงููุฉ ูุงููุฉ ุจูู API ูุงููุงุฌูุฉ!**

## ๐ **ุฎุทูุงุช ุงูุชุญูู ุงูุณุฑูุน:**

1. **ุงูุชุญ ูุฑุญูุฉ ููุชุญุฑูุฑ** โ ุชุญูู ูู ุฃู ุงูุงูุชูุงูุงุช ุงูุญุงููุฉ ููุญุฏุฏุฉ
2. **ุบูุฑ ุงูุงูุชูุงูุงุช** โ ุงุญูุธ โ ุชุญูู ูู ุงูุชุญุฏูุซ ุงูููุฑู
3. **ุชุญูู ูู Console** โ ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู ุชุญููู ุงูุจูุงูุงุช
4. **ุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช** โ ุงูุงูุชูุงูุงุช ูุญููุธุฉ ุจุดูู ุตุญูุญ

**ุฅุฐุง ูุงู ููุงู ุฃู ูุดููุฉุ ุฃุฎุจุฑูู ูุณุฃุณุงุนุฏู ูู ุญููุง ููุฑุงู!**
