# ميزة إنشاء العمليات الجديدة

## نظرة عامة

تم تنفيذ ميزة شاملة لإنشاء عمليات عمل جديدة باستخدام `POST /api/processes`. تتضمن هذه الميزة:

- نموذج إنشاء تفاعلي مع واجهة مستخدم محسنة
- التحقق من صحة البيانات
- معاينة مباشرة للعملية
- معالجة الأخطاء والنجاح
- تحديث تلقائي لقائمة العمليات

## الملفات المضافة/المحدثة

### 1. مكونات جديدة

#### `src/components/processes/CreateProcessModal.tsx`
- نموذج منبثق لإنشاء العملية
- حقول مطلوبة: الاسم، الوصف
- حقول اختيارية: اللون، الأيقونة
- التحقق من صحة البيانات في الوقت الفعلي
- معاينة مباشرة للعملية
- معالجة حالات التحميل والأخطاء

#### `src/components/ui/SuccessNotification.tsx`
- إشعار نجاح قابل للتخصيص
- إغلاق تلقائي مع شريط تقدم
- إمكانية الإغلاق اليدوي
- تصميم جذاب ومتجاوب

### 2. تحديث الخدمات

#### `src/services/mockProcessService.ts`
- إضافة وظيفة `createProcess`
- التحقق من البيانات المطلوبة
- التحقق من عدم تكرار الأسماء
- إنشاء مرحلة افتراضية "جديد"
- تحديث الإحصائيات تلقائياً

#### `src/hooks/useProcesses.ts`
- إضافة وظيفة `createProcess`
- تحديث قائمة العمليات بعد الإنشاء
- تحديث الإحصائيات تلقائياً
- معالجة الأخطاء

### 3. تحديث المكونات الموجودة

#### `src/components/processes/ProcessManager.tsx`
- إضافة زر "عملية جديدة"
- تكامل مع نموذج الإنشاء
- عرض إشعارات النجاح
- تحديث تلقائي للبيانات

## الميزات المنفذة

### 1. نموذج الإنشاء
```typescript
interface ProcessFormData {
  name: string;        // مطلوب - اسم العملية
  description: string; // مطلوب - وصف العملية
  color: string;       // اختياري - لون العملية
  icon: string;        // اختياري - أيقونة العملية
}
```

### 2. التحقق من صحة البيانات
- **اسم العملية**: مطلوب، 3 أحرف على الأقل
- **وصف العملية**: مطلوب، 10 أحرف على الأقل
- **عدم تكرار الأسماء**: التحقق من عدم وجود عملية بنفس الاسم

### 3. خيارات التخصيص
- **12 لون مختلف**: من الأزرق إلى الوردي الداكن
- **10 أيقونات مختلفة**: مجلد، عربة تسوق، تقويم، إلخ
- **معاينة مباشرة**: رؤية العملية كما ستظهر في القائمة

### 4. تجربة المستخدم المحسنة
- مؤشرات تحميل أثناء الإنشاء
- رسائل خطأ واضحة
- إشعار نجاح مع اسم العملية
- إغلاق تلقائي للنموذج بعد النجاح

## كيفية الاستخدام

### 1. فتح نموذج الإنشاء
```typescript
// النقر على زر "عملية جديدة" في ProcessManager
<button onClick={() => setIsCreating(true)}>
  عملية جديدة
</button>
```

### 2. ملء البيانات
- **اسم العملية**: مثل "طلبات المشتريات"
- **وصف العملية**: وصف مفصل للغرض من العملية
- **اختيار اللون**: من الألوان المتاحة
- **اختيار الأيقونة**: من الأيقونات المتاحة

### 3. المعاينة والإرسال
- مراجعة المعاينة في أسفل النموذج
- النقر على "إنشاء العملية"
- انتظار التأكيد والإشعار

## API Integration

### 1. Endpoint المطلوب
```
POST /api/processes

Request Body:
{
  "name": "طلبات المشتريات",
  "description": "إدارة طلبات المشتريات والموافقات",
  "color": "bg-blue-500",
  "icon": "ShoppingCart"
}

Response:
{
  "success": true,
  "data": {
    "id": "process_123",
    "name": "طلبات المشتريات",
    "description": "إدارة طلبات المشتريات والموافقات",
    "color": "bg-blue-500",
    "icon": "ShoppingCart",
    "created_by": "user_id",
    "created_at": "2024-01-20T10:00:00Z",
    "is_active": true,
    "stages": [...],
    "fields": [],
    "settings": {...}
  },
  "message": "تم إنشاء العملية بنجاح"
}
```

### 2. معالجة الأخطاء
```
Response (Error):
{
  "success": false,
  "message": "يوجد عملية بنفس الاسم بالفعل"
}
```

## الإعدادات الافتراضية

### 1. العملية الجديدة تتضمن:
- **مرحلة افتراضية**: "جديد" باللون الرمادي
- **حالة نشطة**: `is_active: true`
- **إعدادات افتراضية**: إشعارات مفعلة، أولوية متوسطة
- **بدون حقول**: يمكن إضافتها لاحقاً

### 2. إعدادات الإشعارات الافتراضية:
```typescript
notification_settings: {
  email_notifications: true,
  in_app_notifications: true,
  notify_on_assignment: true,
  notify_on_stage_change: true,
  notify_on_due_date: true,
  notify_on_overdue: true
}
```

## التحسينات المستقبلية

1. **قوالب العمليات**: قوالب جاهزة للعمليات الشائعة
2. **استيراد العمليات**: استيراد من ملفات Excel/CSV
3. **نسخ العمليات**: إنشاء عملية بناءً على عملية موجودة
4. **مراحل متعددة**: إضافة مراحل أثناء الإنشاء
5. **حقول مخصصة**: إضافة حقول أثناء الإنشاء

## الاختبار

### 1. اختبار النموذج
- فتح نموذج الإنشاء
- اختبار التحقق من صحة البيانات
- اختبار المعاينة المباشرة
- اختبار الإلغاء

### 2. اختبار الإنشاء
- إنشاء عملية جديدة
- التحقق من ظهورها في القائمة
- التحقق من تحديث الإحصائيات
- اختبار إشعار النجاح

### 3. اختبار معالجة الأخطاء
- محاولة إنشاء عملية بنفس الاسم
- اختبار البيانات الناقصة
- اختبار انقطاع الاتصال

## الدعم التقني

للمساعدة في استخدام أو تطوير هذه الميزة:
- مراجعة كود المصدر في الملفات المذكورة
- اختبار الوظائف في بيئة التطوير
- مراجعة رسائل الخطأ في console المتصفح
