# ๐ง ุญู ูุดุงูู ูุฒุงููุฉ ุญุงูุฉ ุงููุฑุงุญู

## ๐ฏ **ุงููุดุงูู ุงููุญุฏุฏุฉ:**

### **ุงููุดููุฉ 1: ุนุฏู ูุฒุงููุฉ ุงูุญุงูุฉ ุงููุญููุฉ**
- ุงูุชุญุฏูุซุงุช ุชุชู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจูุฌุงุญ
- ููู ุงููุงุฌูุฉ ูุง ุชุธูุฑ ุงูุชุญุฏูุซุงุช ููุฑุงู
- ุชุญุชุงุฌ ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ ูุฑุคูุฉ ุงูุชุบููุฑุงุช

### **ุงููุดููุฉ 2: ุญููู ููููุฏุฉ ูู ุงูุชุญุฏูุซ**
- `allowed_transitions` ูุง ูุชู ุชุญุฏูุซูุง
- `is_initial` ู `is_final` ูุง ุชุธูุฑ ุงูุชุญุฏูุซุงุช

## โ **ุงูุญููู ุงููุทุจูุฉ:**

### **1. ุฅุตูุงุญ ุงููุตูู ูุงุณุชุฌุงุจุฉ API**
```typescript
// ูุจู ุงูุฅุตูุงุญ โ
updateStageInProcess(selectedProcess.id, result.stage);

// ุจุนุฏ ุงูุฅุตูุงุญ โ
updateStageInProcess(selectedProcess.id, result.data);
```
**ุงูุณุจุจ**: API ูุฑุฌุน ุงูุจูุงูุงุช ูู `result.data` ูููุณ `result.stage`

### **2. ุฅุถุงูุฉ ุงูุญููู ุงูููููุฏุฉ ูู ุทูุจ ุงูุชุญุฏูุซ**
```typescript
const updateData = {
  name: stageForm.name.trim(),
  description: stageForm.description?.trim() || '',
  color: stageForm.color || '#6B7280',
  priority: stageForm.priority,
  is_initial: stageForm.is_initial || false,
  is_final: stageForm.is_final || false,
  sla_hours: stageForm.sla_hours || null,
  allowed_transitions: stageForm.allowed_transitions || [], // โ ูุถุงู
  required_permissions: [],
  automation_rules: [],
  settings: {}
};
```

### **3. ุชุญุณูู ุฏุงูุฉ updateStageInProcess**
```typescript
// ุชุญุฏูุซ ูุญุณู ูุน ุงูุญูุงุธ ุนูู ุฌููุน ุงูุญููู
stage.id === updatedStage.id 
  ? { 
      ...stage, 
      ...updatedStage,
      // ุงูุชุฃูุฏ ูู ุชุถููู ุฌููุน ุงูุญููู ุงููููุฉ
      allowed_transitions: updatedStage.allowed_transitions || stage.allowed_transitions || [],
      is_initial: updatedStage.is_initial !== undefined ? updatedStage.is_initial : stage.is_initial,
      is_final: updatedStage.is_final !== undefined ? updatedStage.is_final : stage.is_final,
      fields: updatedStage.fields || stage.fields || [],
      transition_rules: updatedStage.transition_rules || stage.transition_rules || [],
      automation_rules: updatedStage.automation_rules || stage.automation_rules || []
    } 
  : stage
```

### **4. ุฅุฒุงูุฉ ุงูุชุฃุฎูุฑ ุบูุฑ ุงูุถุฑูุฑู**
```typescript
// ูุจู ุงูุฅุตูุงุญ โ
setTimeout(() => {
  updateStageInProcess(selectedProcess.id, result.data);
}, 100);

// ุจุนุฏ ุงูุฅุตูุงุญ โ
updateStageInProcess(selectedProcess.id, result.data);
```
**ุงูุณุจุจ**: ุงูุชุฃุฎูุฑ ูุงู ูุณุจุจ ุนุฏู ูุฒุงููุฉ ููุฑูุฉ

### **5. ุชุญุณูู ุชุณุฌูู ุงูุฃุฎุทุงุก ูุงูุชุชุจุน**
- ุฅุถุงูุฉ console.log ููุตู ูุชุชุจุน ุงูุชุญุฏูุซุงุช
- ุนุฑุถ ุงููุฑุญูุฉ ุงููุญุฏุซุฉ ูู ุงููููุณูู
- ุชุญุณูู ุฑุณุงุฆู ุงูุฎุทุฃ

## ๐ **ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**

### **ูุจู ุงูุฅุตูุงุญ โ:**
1. ุชุญุฏูุซ ุงููุฑุญูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช โ
2. ุฅุบูุงู ุงูููุฏุงู โ
3. **ุงููุงุฌูุฉ ูุง ุชุธูุฑ ุงูุชุญุฏูุซุงุช** โ
4. **ุญููู allowed_transitions ููููุฏุฉ** โ
5. **ุญููู is_initial/is_final ูุง ุชุชุญุฏุซ** โ

### **ุจุนุฏ ุงูุฅุตูุงุญ โ:**
1. ุชุญุฏูุซ ุงููุฑุญูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช โ
2. ุฅุบูุงู ุงูููุฏุงู โ
3. **ุชุญุฏูุซ ููุฑู ูููุงุฌูุฉ** โ
4. **ุฌููุน ุงูุญููู ุชุชุญุฏุซ ุจูุง ูู ุฐูู allowed_transitions** โ
5. **ุญููู is_initial/is_final ุชุนูู ุจุดูู ุตุญูุญ** โ

## ๐งช **ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ:**

### **1. ุงุฎุชุจุงุฑ ุงูุชุญุฏูุซ ุงูุฃุณุงุณู:**
```bash
# ุชุดุบูู ุงูุฎุงุฏู
cd api && node server.js
```

### **2. ุงุฎุชุจุงุฑ ุงูุญููู ุงูุฃุณุงุณูุฉ:**
- ุงูุชุญ `http://localhost:5174/processes`
- ุงุฎุชุฑ ุนูููุฉ ูุงุถุบุท ุนูู ุชุญุฑูุฑ ูุฑุญูุฉ
- ุบูุฑ ุงูุงุณู ูุงููุตู ูุงูููู
- ุงุถุบุท "ุญูุธ ุงูุชุบููุฑุงุช"
- **ุชุญูู**: ุงูุชุบููุฑุงุช ุชุธูุฑ ููุฑุงู ูู ุงููุงุฆูุฉ

### **3. ุงุฎุชุจุงุฑ Allowed Transitions:**
- ูู ููุณ ูููุฐุฌ ุงูุชุญุฑูุฑ
- ุงุฎุชุฑ ูุฑุงุญู ูุฎุชููุฉ ูู ูุณู "ุงูุงูุชูุงูุงุช ุงููุณููุญุฉ"
- ุงุญูุธ ุงูุชุบููุฑุงุช
- **ุชุญูู**: ุนุฏุฏ ุงูุงูุชูุงูุงุช ูุธูุฑ ูู ุจุทุงูุฉ ุงููุฑุญูุฉ

### **4. ุงุฎุชุจุงุฑ Stage Types:**
- ูู ูููุฐุฌ ุงูุชุญุฑูุฑ
- ูุนู/ุฃูุบ "ูุฑุญูุฉ ุฃููู" ุฃู "ูุฑุญูุฉ ููุงุฆูุฉ"
- ุงุญูุธ ุงูุชุบููุฑุงุช
- **ุชุญูู**: ุงูุชุณููุงุช "ุฃููู" ุฃู "ููุงุฆูุฉ" ุชุธูุฑ/ุชุฎุชูู ููุฑุงู

### **5. ุงุฎุชุจุงุฑ Console Logs:**
ุงูุชุญ Developer Tools ูุชุญูู ูู ุงูุฑุณุงุฆู:
```
๐ ุชุญุฏูุซ ูุฑุญูุฉ ูู ุงูุนูููุฉ: [processId] [stageData]
๐ ุชู ุชุญุฏูุซ ูุงุฆูุฉ ุงูุนูููุงุช - ุชุญุฏูุซ ุงููุฑุญูุฉ
๐ ุงููุฑุญูุฉ ุงููุญุฏุซุฉ: [updatedStageData]
๐ ุชู ุชุญุฏูุซ ุงูุนูููุฉ ุงููุฎุชุงุฑุฉ - ุชุญุฏูุซ ุงููุฑุญูุฉ
โ ุชู ุชุญุฏูุซ ุงููุฑุญูุฉ ูู ุงูุญุงูุฉ ุงููุญููุฉ
```

## ๐ง **ุงููููุงุช ุงูููุญุฏููุซุฉ:**

### **1. `src/components/processes/ProcessManager.tsx`**
- ุฅุตูุงุญ ุงููุตูู ูู `result.data` ุจุฏูุงู ูู `result.stage`
- ุฅุถุงูุฉ `allowed_transitions` ูู `updateData`
- ุฅุฒุงูุฉ `setTimeout` ููุชุญุฏูุซ ุงูููุฑู

### **2. `src/contexts/WorkflowContext.tsx`**
- ุชุญุณูู ุฏุงูุฉ `updateStageInProcess`
- ุฅุถุงูุฉ ุญูุงูุฉ ุดุงููุฉ ููุญููู
- ุชุญุณูู ุชุณุฌูู ุงูุฃุฎุทุงุก ูุงูุชุชุจุน

## ๐ฏ **ุงูููุฒุงุช ุงููุญุณูุฉ:**

### **โ ูุฒุงููุฉ ููุฑูุฉ:**
- ุงูุชุญุฏูุซุงุช ุชุธูุฑ ููุฑุงู ุจุฏูู ุฅุนุงุฏุฉ ุชุญููู
- ุฌููุน ุงูุญููู ุชุชุญุฏุซ ุจุดูู ุตุญูุญ

### **โ ุญููู ูุงููุฉ:**
- `allowed_transitions` ุชุนูู ุจุดูู ูุงูู
- `is_initial` ู `is_final` ุชุชุญุฏุซ ููุฑุงู
- ุฌููุน ุฎุตุงุฆุต ุงููุฑุญูุฉ ูุญููุธุฉ

### **โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุญุณูุฉ:**
- ูุง ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ
- ุฑุฏูุฏ ูุนู ููุฑูุฉ ุนูู ุงูุชุบููุฑุงุช
- ุฅุดุนุงุฑุงุช ูุงุถุญุฉ ููููุฏุฉ

---

**๐ ุชู ุญู ุฌููุน ูุดุงูู ูุฒุงููุฉ ุญุงูุฉ ุงููุฑุงุญู ุจุงููุงูู!**
